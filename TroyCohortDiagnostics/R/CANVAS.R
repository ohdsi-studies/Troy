# Load RCT information
tcList <- read.csv("C:/git/Troy/TroyCohortDiagnostics/inst/settings/TargetComparatorList.csv") #Should be change path
trials <- "CANVAS"
idx <- which(tcList[,"trial"] == trials)
RCTbaseline <- read.csv(file.path("C:/git/Troy/TroyCohortDiagnostics/inst/csv", paste0(trials[1], ".csv")))
RCTbaseline <- RCTbaseline %>% filter(.data$isNa != 'Y')
RCTbaseline$target <- as.numeric(RCTbaseline$target)
RCTbaseline$comparator <- as.numeric(RCTbaseline$comparator)
RCTbaseline$targetsd <- as.numeric(RCTbaseline$targetsd)
RCTbaseline$comparatorsd <- as.numeric(RCTbaseline$comparatorsd)
RCTbaseline$targetsize <- as.numeric(RCTbaseline$targetsize)
RCTbaseline$comparatorsize <- as.numeric(RCTbaseline$comparatorsize)

cohort <- Andromeda::andromeda()  
sql <- "select * from @cohortDatabaseSchema.@cohortTable"
sql <- SqlRender::render(sql, cohortDatabaseSchema=cohortDatabaseSchema, cohortTable=cohortTable)
DatabaseConnector::querySqlToAndromeda(connection, sql, andromeda = cohort, andromedaTableName = "cohort")


#########################
### Eligible criteria ###
#########################
tc <- tcList[idx[1],c(1,2)]
targetNumber <- tc[1,1]
comparatorNumber <- tc[1,2]
targetCohort <- cohort$cohort %>% filter(.data$COHORT_DEFINITION_ID == targetNumber) %>% mutate(treatment = 1)
comparatorCohort <- cohort$cohort %>% filter(COHORT_DEFINITION_ID == comparatorNumber) %>% mutate(treatment = 0)
population <- targetCohort %>% union(comparatorCohort)
population <- rename(population, rowId = SUBJECT_ID)

sizeOE <- data.frame(treatment = -1, n = population %>% summarise(n = n_distinct(.data$rowId)))
sizeOE <- rbind(sizeOE, data.frame(population %>% group_by(.data$treatment) %>% tally()))

covariateSettings <- createCovariateSettings(useDemographicsGender = TRUE,
                                             useDemographicsAge = TRUE,
                                             useDemographicsRace = TRUE,
                                             useMeasurementValueAnyTimePrior = TRUE,
                                             useDrugGroupEraLongTerm = TRUE,
                                             useConditionOccurrenceLongTerm = TRUE,
                                             useProcedureOccurrenceLongTerm = TRUE)

covariates <- getDbCovariateData(connectionDetails = connectionDetails,
                                 cdmDatabaseSchema = cdmDatabaseSchema,
                                 cohortDatabaseSchema = cohortDatabaseSchema,
                                 cohortTable = cohortTable,
                                 cohortId = c(targetNumber, comparatorNumber),
                                 covariateSettings = covariateSettings)

covariates$covariates <- covariates$covariates %>% left_join(population, by=("rowId"), copy = TRUE)
covariates$covariates <- covariates$covariates %>% left_join(covariates$covariateRef)

statisticsPooled <- covariates$covariates %>%
  group_by(.data$covariateId) %>%
  summarise(sum = sum(as.numeric(.data$covariateValue), na.rm = TRUE),
            mean = mean(as.numeric(.data$covariateValue), na.rm = TRUE),
            sumSqr = sum(as.numeric(.data$covariateValue)^2, na.rm = TRUE),
            median = median(as.numeric(.data$covariateValue), na.rm = TRUE),
            n = n(),
            min = min(as.numeric(.data$covariateValue), na.rm = TRUE),
            max = max(as.numeric(.data$covariateValue), na.rm = TRUE)) %>%
  mutate(sd = sqrt(abs(.data$sumSqr - .data$mean^2))) 

statisticsPooled <- statisticsPooled %>% left_join(covariates$covariateRef) 
statisticsPooled <- statisticsPooled %>% left_join(select(covariates$analysisRef, analysisId, isBinary), by=("analysisId"))

# Result for CANVAS trial
resultTablePooled <- data.frame()

# Mean age
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter (covariateId == 1002)))

# Female
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter (covariateId == 8532001)))

# Hypertension
hpt <- c(132685,134414,135601,136743,136760,137940,141084,141639,192684,197930,200157,201912,312648,314090,314103,314423,314958,316866,317895,317898,318437,319826,320128,320456,321074,321080,321638,433536,438490,439077,439393,441922,443771,762994,3169253,3191244,3656115,4006325,4023318,4028741,4028951,4032952,4034031,4034094,4034095,4035655,4048212,4049389,4057976,4057978,4057979,4058987,4061667,4062550,4062811,4062906,4071202,4080325,4083723,4094374,4108213,4110947,4110948,4118910,4146627,4146816,4148205,4151903,4159755,4162306,4167358,4167493,4174979,4178312,4179379,4180283,4199306,4209293,4212496,4215640,4217486,4218088,4219323,4221991,4227607,4242878,4249016,4253928,4262182,4263067,4269358,4276511,4277110,4279525,4283352,4289142,4289933,4291933,4302591,4304837,4305599,4311246,4316372,4321603,4322735,35622939,35624277,36713024,36715087,37016726,37208172,37208293,40481896,42538697,42538946,42873163,43020424,43021830,44783643,44783644,44784483,44784484,44809026,44809027,44809548,44809569,44811110,44811932,44811933,45757119,45757137,45757356,45757444,45757445,45757446,45757447,45757787,45757788,45768449,45771064,45771067)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% hpt) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: Hypertension"

# Medical history: CHF
chf <- c(314378,316994,319835,439694,439696,439698,762002,762003,764874,4023479,4139864,4142561,4206009,4215446,4229440,4242669,4284562,4327205,36712927,36712928,36713488,37309625,43021825,43021826,43022068,44782428,44782655,44782713,44782728,44784345,44784442)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% chf) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: Congestive Heart Failure"

# Medical history: retinopathy
retinopathy <- c(376114,376683,377552,378743,380096,380097,761053,765373,3655235,3655913,3655914,3655948,3656194,3656195,4101478,4105172,4105173,4151453,4161670,4161671,4162095,4164174,4164175,4164176,4164632,4174977,4195043,4195044,4195498,4199039,4209538,4210128,4210129,4210872,4210874,4212441,4215961,4218499,4221344,4221962,4223463,4226121,4227210,4235260,4247107,4252356,4255399,4255400,4255401,4266041,4266042,4266637,4269870,4269871,4290822,4290823,4334884,4336000,4338900,4338901,35626036,35626037,35626038,35626039,35626041,35626042,35626043,35626044,35626046,35626047,35626067,35626068,35626069,35626070,35626071,35626072,35626087,35626088,35626764,35626904,35626905,36674199,36674200,36674752,36674753,36674765,36674766,37016179,37016180,37016356,37016357,37016358,37311253,37311254,37311832,37311833,43530656,43530685,44805628,45757065,45757073,45757075,45757266,45757435,45763583,45763584,45769873,45770830,45770831,45770881,45770928,45770986,45773064)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% retinopathy) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: retinopathy"

# Medical history: Neuropathy

neuropathy <- c(74635,75949,76396,76685,76831,78647,78937,79212,81195,81400,81425,133646,134331,136865,137548,137858,138148,138612,138682,138936,140090,141004,142033,192239,192885,193079,193186,194149,194913,195259,196307,197042,197089,197608,197852,197857,199086,200611,200644,372309,372409,372828,372888,372914,372915,372999,373082,373101,373190,373206,373470,373487,373488,373497,374027,374032,374221,374360,374912,374923,374925,374954,375260,375428,375458,375631,375716,375806,375823,376028,376112,376395,376686,376963,376989,377271,377565,377570,377680,377789,378135,378140,378420,378421,378439,378686,378741,379801,379818,380030,380094,380265,380394,380398,380410,380729,380995,381009,381312,381504,381551,381572,381732,381733,381861,381952,382014,382034,432307,432893,433480,433642,433916,433975,434530,434824,434929,435138,435253,435269,435537,435701,435803,436684,436702,436806,436936,437161,437262,437496,437543,437547,437763,437876,438155,438961,439211,439308,439807,439842,440703,440890,440893,441479,441564,441845,441848,442305,442529,443225,443450,443606,443776,444123,444214,444218,444263,444382,751708,760127,760892,760893,760908,760909,760925,760979,761121,761122,761217,761320,761321,761328,761329,761346,761347,761377,761378,761521,761522,761523,761524,761525,761526,761527,761528,761529,761634,761635,761845,761846,761847,761848,761849,761850,761859,761860,761866,761867,761868,761869,761870,761871,761884,761934,761987,762067,762069,762070,762071,762072,762073,762074,762075,762076,762077,762078,762079,762100,762101,762102,762103,762104,762107,762108,762109,762110,762111,762112,762113,762114,762115,762116,762117,762118,762120,762121,762122,762123,762125,762126,762127,762128,762129,762131,762132,762133,762134,762135,762136,762137,762138,762139,762142,762143,762144,762145,762146,762150,762151,762156,762280,762346,762347,762352,762353,762355,762356,762831,763930,764593,764917,764965,765022,765027,765042,765085,765086,765127,765128,765139,765140,765141,765142,765147,765148,765235,765318,765419,765472,765473,765474,765485,765486,765650,1552972,1553049,1553059,1553070,1553078,1553098,1553103,1553113,1553138,1553151,1553183,1553245,1553296,1553297,1553351,1553360,1553368,1553388,1553392,1553397,1553431,1553433,1553442,1553449,1553453,1553462,1553504,1553507,1553511,1553519,1553531,1553532,1553548,1553556,1553565,1553581,1553588,1553591,3170099,3171310,3172374,3173531,3174623,3174710,3174862,3176403,3177327,3177449,3178878,3178922,3182576,3184100,3184959,3185305,3186860,3192039,3654615,3654627,3654628,3654629,3654630,3654632,3654638,3654652,3654654,3654655,3654664,3654670,3654884,3654915,3654917,3655188,3655277,3655278,3655279,3655280,3655281,3655282,3655283,3655284,3655340,3655341,3655374,3655583,3655603,3655604,3655617,3655624,3655625,3655626,3655627,3655628,3655630,3655660,3655667,3655670,3655822,3655823,3655824,3655825,3655844,3655846,3655870,3657084,3657085,3657135,3657146,3657796,3657808,3657809,3657810,3657841,3657842,3657878,3657879,3657880,4000958,4001318,4001319,4001320,4001321,4001322,4001450,4002030,4002173,4002341,4002342,4002343,4002344,4002345,4002346,4002348,4002349,4002350,4002351,4002352,4002353,4002470,4003173,4003174,4003175,4003176,4003177,4003178,4003179,4003694,4003826,4003827,4005774,4005775,4006988,4008510,4009037,4009555,4009644,4010074,4013309,4013312,4014938,4017394,4017951,4018085,4023792,4024519,4025822,4027372,4027396,4027533,4027537,4027538,4027732,4028085,4028086,4029117,4029646,4029822,4030066,4030590,4030591,4030592,4030598,4030737,4031719,4031720,4032347,4032348,4032800,4033872,4042414,4043401,4043566,4043573,4043574,4043575,4043576,4043577,4043579,4043580,4043581,4043672,4043673,4043711,4043712,4043713,4043714,4043716,4043717,4043718,4043719,4043720,4043721,4043722,4043723,4043725,4043726,4043727,4043729,4043730,4043889,4043890,4043891,4043912,4044021,4044073,4044075,4044244,4044245,4044247,4044248,4044249,4044254,4044255,4044351,4044384,4044385,4044386,4044388,4044390,4044391,4044392,4044393)
neuropathy <- c(neuropathy, 4044394,4044396,4044397,4044398,4044399,4044401,4044402,4044403,4044404,4044405,4044407,4044408,4044409,4044411,4044412,4045630,4045631,4045632,4045633,4045724,4045725,4045727,4045728,4045729,4045730,4045731,4045732,4045968,4046240,4046241,4046242,4046330,4046331,4046332,4046335,4046336,4046338,4046339,4046340,4046341,4046342,4046343,4046344,4046346,4046347,4046348,4046349,4046350,4046351,4046353,4046354,4046355,4046356,4046357,4046908,4047760,4047859,4047862,4047883,4047884,4047917,4047918,4048016,4048017,4048018,4048020,4048022,4048023,4048024,4048025,4048027,4048028,4048029,4048030,4048031,4048032,4048033,4048035,4048036,4048037,4048038,4048039,4048040,4048041,4048043,4048044,4048045,4048046,4048047,4048048,4048049,4048050,4048061,4048157,4048435,4048653,4048654,4048655,4048656,4048740,4048779,4048780,4048782,4049810,4050856,4050964,4053308,4054754,4054762,4054763,4054765,4054766,4054767,4054768,4054769,4054770,4054771,4054772,4054773,4054774,4054812,4054852,4054853,4054854,4054855,4054856,4054857,4054859,4054860,4054861,4054862,4054864,4054865,4054866,4054867,4054868,4054869,4054870,4054872,4054873,4054878,4054879,4055222,4055468,4055855,4056885,4056886,4056887,4056889,4056890,4056891,4056892,4056893,4056894,4056895,4056898,4056899,4056900,4056901,4056902,4057017,4057018,4057019,4057020,4057022,4057023,4057027,4057028,4057029,4057030,4057031,4057032,4057033,4057035,4057036,4057037,4057038,4058948,4058953,4058956,4058957,4058958,4058959,4058960,4058961,4058962,4058963,4058964,4058965,4058966,4059086,4059088,4059090,4059091,4059092,4059094,4059095,4059096,4059097,4059098,4059100,4059101,4059102,4059103,4059104,4059105,4059106,4059107,4059108,4059109,4059110,4059112,4059113,4059115,4059116,4062108,4062109,4062110,4062111,4062221,4062222,4062224,4062225,4062226,4062227,4062228,4062229,4062230,4062231,4062232,4062233,4062234,4062235,4062236,4062238,4062239,4062240,4062242,4062243,4062244,4062245,4062246,4062456,4062477,4062566,4062577,4062581,4062844,4062845,4063207,4063208,4063211,4067531,4067933,4068009,4068023,4068111,4068476,4068477,4068617,4069195,4069205,4070527,4070552,4071154,4071164,4071499,4077819,4078976,4078977,4079019,4079325,4080134,4080146,4080337,4080382,4081178,4081219,4082016,4082017,4082271,4082299,4082302,4082768,4082774,4083777,4085741,4086178,4086317,4087081,4087805,4090560,4091559,4091621,4092713,4094260,4094261,4094262,4094959,4094960,4094961,4094962,4094964,4095302,4095429,4095536,4095537,4095538,4095539,4095540,4095542,4095543,4095544,4095892,4096003,4096004,4096005,4096006,4096007,4096628,4096629,4096630,4096632,4096633,4096634,4097283,4097284,4098118,4099985,4099986,4100902,4100903,4101333,4101567,4101880,4101885,4101886,4101887,4101891,4101892,4101893,4101894,4101895,4101898,4102093,4102342,4102360,4102481,4102485,4102492,4102493,4102494,4102498,4102732,4103124,4103235,4103776,4104196,4104844,4104845,4104850,4105005,4105009,4105014,4105016,4105017,4105018,4105020,4105021,4105341,4105632,4105633,4105637,4105639,4105640,4105642,4105643,4106172,4106554,4107377,4109232,4109393,4110655,4110889,4110890,4111031,4111033,4112480,4112481,4112968,4112970,4112971,4112972,4112973,4112974,4114346,4114427,4116215,4116216,4116217,4116572,4116573,4116574,4116861,4117355,4117779,4119333,4120317,4121325,4121336,4121337,4125693,4129225,4130042,4130043,4130044,4130045,4130046,4130047,4130048,4130049,4130051,4130052)
neuropathy <- c(neuropathy, 4130544,4130545,4130661,4130662,4130859,4131025,4131106,4131107,4131109,4131110,4131111,4131117,4131651,4131769,4131773,4131774,4131775,4131776,4131778,4131779,4131780,4131946,4134121,4134122,4134123,4134432,4134434,4134435,4134455,4134456,4134578,4134579,4134580,4134605,4135454,4136547,4136548,4136549,4136977,4137352,4137353,4138332,4138486,4139215,4139780,4140466,4142399,4143237,4143360,4143363,4143857,4143862,4143863,4144833,4144942,4144949,4146840,4147504,4147643,4149325,4150993,4151147,4151196,4151197,4151210,4151221,4151222,4151223,4151224,4151226,4151227,4151453,4151978,4151979,4151980,4151992,4151993,4152299,4152300,4152336,4152403,4152405,4152559,4152601,4154172,4154173,4154174,4154285,4154286,4156050,4160056,4160362,4160436,4160896,4161284,4161285,4161309,4161817,4161823,4162241,4162701,4164292,4164436,4164604,4164770,4165746,4166067,4169073,4170714,4171706,4172489,4172528,4173311,4173826,4174262,4174405,4174699,4175202,4175440,4176139,4176925,4177338,4177483,4177506,4177633,4177634,4177635,4177637,4177993,4178773,4178975,4180912,4181181,4181748,4181849,4181888,4182422,4182543,4182965,4182966,4183120,4183121,4183122,4183124,4183297,4184946,4185022,4185023,4185083,4185598,4187079,4187326,4187806,4188350,4188610,4189184,4189235,4189646,4189667,4190334,4190712,4190744,4191611,4193776,4194060,4194629)
neuropathy <- c(neuropathy, 4194800,4194827,4194878,4194970,4195005,4195055,4196109,4196227,4196252,4196277,4197058,4197114,4197570,4199517,4199740,4200647,4200854,4201143,4202065,4202381,4202652,4204694,4206139,4208028,4208207,4208208,4208987,4209280,4209749,4210321,4211961,4212083,4212449,4215003,4215344,4215954,4216000,4216397,4217060,4218724,4218753,4219507,4219543,4219977,4220079,4220165,4220673,4221637,4221837,4221916,4222415,4223942,4224011,4224242,4225055,4225278,4225528,4226662,4226864,4227072,4227519,4227617,4228419,4228745,4229396,4229405,4230363,4231315,4231893,4232789,4234742,4235717,4237144,4237155,4237198,4237315,4238686,4239243,4239725,4239870,4239889,4240232,4240908,4241035,4241532,4241662,4242345,4242528,4242743,4242811,4242812,4242813,4242834,4242858,4242978,4242979,4243451,4243644,4243770,4244092,4244491,4245501,4245986,4246013,4246029,4246042,4246080,4246137,4246246,4246247,4246248,4246923,4247334,4247716,4247829,4247847,4248131,4248189,4248190,4248551,4249573,4251046,4252861,4253627,4253668,4259501,4259502,4260193,4260823,4262282,4263090,4264613,4264853,4264920,4265579,4265860,4266036,4268260,4268878,4268973,4270614,4271311,4271570,4271598,4272636,4274480,4275414,4275445,4275753,4280953,4282137,4282476,4283669,4286352,4289591,4292056,4292064,4292375,4294272,4295312,4295340,4295421,4296728,4298153,4300531,4300679,4301699,4303516,4304701,4305174,4305334,4307319,4307553,4307721,4307728,4307729,4308142,4308256,4308406,4308632,4308780,4309193,4309357,4309914,4310159,4311158,4311493,4311539,4311625,4311630,4311631,4311706,4311708,4311957,4312039,4312426,4312559,4312924,4312937,4312946,4312956,4313085,4313218,4313232,4313233,4313354,4313379,4313439,4313505,4313507,4313653,4313879,4314002,4314070,4314496,4315532,4315939,4316209,4316382,4316747,4317132,4317564,4317828,4317967,4317989,4318100,4318525,4318562,4318677,4318678,4318703,4318869,4319256,4319437,4319472,4319608,4320696,4322033,4322638,4322891,4323048,4327957,4328334,4328365,4328422,4328943,4329158,4335337,4336520,4336813,4337830,4338235,4338900,4338904,4345229,4347542,4347543,4348435,35607977,35608085,35608120,35610241,35610439,35621928,35621979,35622040,35622286,35622356,35622507,35622694,35623047,35623634,35624130,35624152,35624271,35624321,35624758,35625841,35625847,35625955,35626761,35626762,35626765,36402561,36403094,36403098,36403100,36403135,36403136,36403158,36517203,36517204,36517205,36517227,36517229,36517250,36517282,36517306,36517311,36517347,36517350,36517357,36517382,36517403,36517418,36517423,36517449,36517452,36517539,36517540,36517576,36517579,36517661,36517681,36517692,36517702,36517726,36517756,36517765,36517773,36517790,36517794,36517805,36517818,36517848,36517961,36518006,36518007,36518086)
neuropathy <- c(neuropathy, 36518097,36518137,36518176,36518193,36518209,36518257,36518299,36518327,36518350,36518359,36518360,36518409,36518480,36518501,36518513,36518523,36518533,36518552,36518553,36518581,36518598,36518607,36518619,36518635,36518663,36518701,36518704,36518735,36518764,36518769,36518774,36518788,36518798,36518821,36518846,36518857,36518879,36518881,36518885,36518954,36518969,36518995,36519000,36519015,36519046,36519048,36519068,36519111,36519117,36519143,36519144,36519145,36519154,36519203,36519217,36519219,36519327,36519347,36519424,36519454,36519578,36519593,36519611,36519678,36519682,36519698,36519714,36519715,36519782,36519784,36519788,36519791,36519837,36519894,36519911,36519973,36519994,36520013,36520035,36520036,36520042,36520103,36520131,36520145,36520161,36520240,36520274,36520300,36520303,36520306,36520307,36520323,36520328,36520423,36520476,36520484,36520505,36520511,36520521,36520560,36520585,36520591,36520607,36520621,36520639,36520663,36520665,36520672,36520732,36520745,36520845,36520885,36521019,36521043,36521054,36521062,36521087,36521089,36521091,36521148,36521152,36521169,36521186,36521207,36521251,36521253,36521257,36521284,36521359,36521366,36521403,36521413,36521452,36521462,36521464,36521507,36521530,36521585,36521622,36521635,36521642,36521643,36521673,36521676,36521698,36521765,36521827,36521845,36521928,36521945,36521949,36521969,36521992,36522094,36522096,36522105,36522137,36522150,36522192,36522196,36522303,36522320,36522329,36522356,36522363,36522364,36522423,36522440,36522452,36522473,36522505,36522522,36522558,36522577,36522614,36522628,36522635,36522647,36522698,36522734,36522764,36522798,36522801,36522805,36522821,36522824,36522870,36522872,36522885,36522888,36522906,36522916,36522941,36522958,36523025,36523038,36523056,36523067,36523097,36523102,36523105,36523193,36523227,36523229,36523330,36523337,36523339,36523344,36523374,36523392,36523407,36523420,36523442,36523468,36523483,36523489,36523498,36523525,36523530,36523548,36523557,36523622,36523635,36523756,36523763,36523767,36523807,36523823,36523846,36523877,36523891,36523906,36523912,36523936,36523956,36523975,36524000,36524006,36524021,36524039,36524044,36524064,36524066,36524176,36524180,36524223,36524231,36524291,36524320,36524424,36524468,36524475,36524490,36524494,36524499,36524519,36524563,36524583,36524584,36524601,36524608,36524618,36524640,36524653,36524660,36524729,36524738,36524749,36524797,36524845,36524851,36524887,36524891,36524923,36524986,36525008,36525009,36525020,36525056,36525073,36525108,36525109,36525145,36525162,36525167,36525226,36525230,36525273,36525299,36525318,36525322,36525323,36525411,36525439,36525445,36525460,36525485,36525492,36525521,36525532,36525566,36525577,36525595,36525652,36525704,36525710,36525735,36525781,36525817,36525897,36525927,36525931,36525983,36525984,36525994,36526045,36526108,36526128,36526141,36526144,36526217,36526221,36526255,36526257,36526268,36526277,36526306,36526319,36526339,36526431,36526435,36526443,36526450,36526481,36526483,36526519,36526528,36526532,36526537,36526550,36526565,36526577,36526588,36526618,36526635,36526657,36526665,36526677)
neuropathy <- c(neuropathy, 36526698,36526706,36526712,36526757,36526759,36526767,36526798,36526801,36526816,36526828,36526853,36526868,36526885,36526886,36526889,36526959,36527015,36527096,36527098,36527182,36527247,36527312,36527317,36527320,36527323,36527332,36527337,36527367,36527376,36527454,36527484,36527489,36527492,36527550,36527592,36527602,36527661,36527664,36527690,36527763,36527771,36527836,36527837,36527840,36527843,36527888,36527908,36527918,36527942,36527969,36527988,36527989,36527991,36528000,36528006,36528054,36528055,36528062,36528072,36528101,36528107,36528112,36528155,36528175,36528190,36528197,36528199,36528214,36528237,36528272,36528289,36528394,36528486,36528488,36528494,36528502,36528509,36528523,36528534,36528554,36528561,36528606,36528663,36528667,36528713,36528730,36528742,36528805,36528816,36528827,36528864,36528867,36528869,36528990,36529029,36529036,36529047,36529076,36529085,36529094,36529106,36529136,36529142,36529143,36529146,36529157,36529176,36529187,36529204,36529209,36529216,36529219,36529245,36529318,36529351,36529377,36529390,36529448,36529492,36529512,36529543,36529571,36529637,36529642,36529677,36529754,36529771,36529789,36529821,36529842,36529873,36529875,36529886,36529895,36529903,36529909,36530048,36530084,36530131,36530181,36530201,36530292,36530294,36530326,36530424,36530445,36530494,36530497,36530506,36530523,36530626,36530634,36530635,36530637,36530643,36530700,36530743,36530749,36530862,36530866,36530894,36530901,36530942,36530963,36530986,36531021,36531026,36531027,36531032,36531038,36531045,36531050,36531064,36531082,36531086,36531093,36531096,36531142,36531157,36531229,36531266,36531327,36531412,36531437,36531449,36531460,36531480,36531495,36531497,36531502,36531517,36531537,36531540,36531561,36531571,36531597,36531608,36531621,36531649,36531654,36531662,36531674,36531686,36531697,36531748,36531759,36531771,36531792,36531843,36531895,36531916,36531917,36531920,36531936,36531982,36531983,36531985,36531990,36532051,36532084,36532110,36532113,36532147,36532152,36532221,36532225,36532250,36532263,36532273,36532296,36532300,36532324,36532440,36532466,36532468,36532484,36532526,36532547,36532570,36532571,36532573,36532582,36532617,36532644,36532649,36532657,36532662,36532712,36532765,36532775,36532830,36532860,36532862,36532870,36532913,36532939,36532950,36532985,36532992,36533008,36533034,36533053,36533161,36533171,36533180,36533219,36533263,36533279,36533288,36533306,36533320,36533329)
neuropathy <- c(neuropathy, 36533374,36533383,36533423,36533465,36533474,36533530,36533556,36533591,36533603,36533619,36533620,36533635,36533637,36533669,36533670,36533679,36533762,36533776,36533819,36533838,36533870,36533872,36533905,36533927,36533973,36534028,36534049,36534064,36534065,36534080,36534089,36534101,36534113,36534115,36534233,36534235,36534244,36534264,36534410,36534445,36534486,36534506,36534513,36534531,36534545,36534571,36534583,36534587,36534603,36534684,36534761,36534806,36534828,36534834,36534856,36534868,36534895,36534920,36534962,36534965,36534981,36535017,36535027,36535029,36535046,36535054,36535059,36535094,36535103,36535130,36535134,36535156,36535190,36535193,36535206,36535218,36535299,36535361,36535374,36535383,36535409,36535424,36535443,36535451,36535474,36535496,36535505,36535516,36535542,36535581,36535598,36535690,36535700,36535708,36535730,36535759,36535782,36535794,36535807,36535808,36535906,36535921,36535927,36535932,36535940,36535965,36535971,36535982,36535985,36535992,36535999,36536080,36536128,36536149,36536159,36536167,36536186,36536194,36536244,36536255,36536267,36536285,36536292,36536344,36536385,36536470,36536494,36536517,36536526,36536547,36536592,36536638,36536671,36536684,36536694,36536705,36536706,36536760,36536776,36536818,36536846,36536849,36536909,36536983,36536990,36537003,36537010,36537037,36537049,36537091,36537096,36537114,36537122,36537126,36537140,36537160,36537164,36537168,36537175,36537193,36537222,36537231,36537251,36537278,36537286,36537319,36537339,36537341,36537343,36537349,36537360,36537416,36537417,36537443,36537468,36537492,36537505,36537516,36537541,36537597,36537598,36537599,36537611,36537617,36537664,36537674,36537732,36537743,36537755,36537759,36537765,36537787,36537801,36537843,36537852,36537870,36537879,36537950,36537977,36537984,36537996,36538027,36538040,36538049,36538055,36538063,36538065,36538086,36538094,36538123,36538124,36538137,36538204,36538211,36538278,36538298,36538307,36538371,36538410,36538439,36538446,36538467,36538477,36538490,36538515,36538543,36538556,36538589,36538613,36538676,36538693,36538711,36538726,36538730,36538745,36538750,36538767,36538786,36538826,36538840,36538903,36538922,36538983,36538995,36539019,36539022,36539025,36539047,36539069,36539078,36539095,36539130,36539151,36539197,36539227,36539233,36539288,36539317,36539331,36539348,36539379,36539401,36539410,36539421,36539434,36539436,36539465,36539468,36539473,36539561,36539581,36539610,36539621,36539631,36539670,36539706,36539711,36539752,36539824,36539835,36539868,36539899,36539925,36539939,36539946,36539957,36540002,36540006,36540010,36540018,36540032,36540068,36540078,36540140,36540144,36540176,36540184,36540187,36540233,36540252,36540297,36540320,36540335,36540374,36540424,36540458,36540467,36540473,36540492,36540495,36540499,36540507,36540540,36540543,36540729,36540739,36540743,36540807,36540971,36541022,36541046,36541079,36541118,36541132,36541134,36541201,36541215,36541236,36541284,36541317,36541320,36541366,36541368,36541370,36541391,36541424,36541456,36541490,36541552,36541564,36541568,36541585,36541625,36541628)
neuropathy <- c(neuropathy, 36541637,36541639,36541657,36541741,36541769,36541795,36541800,36541813,36541836,36541856,36541907,36541913,36541915,36541920,36541963,36541972,36541982,36541993,36542017,36542037,36542046,36542050,36542071,36542084,36542094,36542101,36542109,36542110,36542133,36542134,36542141,36542143,36542177,36542179,36542185,36542187,36542270,36542275,36542297,36542318,36542320,36542326,36542366,36542377,36542381,36542382,36542387,36542406,36542428,36542437,36542451,36542463,36542545,36542575,36542577,36542613,36542637,36542662,36542691,36542718,36542806,36542907,36542909,36542951,36542967,36542984,36543027,36543036,36543071,36543097,36543101,36543113,36543127,36543147,36543174,36543186,36543203,36543244,36543250,36543258,36543283,36543292,36543329,36543339,36543341,36543353,36543359,36543402,36543445,36543470,36543501,36543512,36543534,36543540,36543545,36543591,36543598,36543661,36543777,36543809,36543831,36543846,36543847,36543856,36543881,36543892,36543900,36543924,36543995,36544057,36544058,36544128,36544132,36544174,36544189,36544238,36544305,36544327,36544333,36544334,36544402,36544440,36544496,36544513,36544528,36544557,36544575,36544582,36544600,36544605,36544629,36544721,36544731,36544741,36544742,36544745,36544788,36544839,36544862,36544872,36544873,36544887,36544930,36544932,36544943,36545004,36545041,36545076,36545175,36545185,36545215,36545220,36545223,36545237,36545250,36545306,36545313,36545322,36545331,36545352,36545368,36545392,36545413,36545421,36545432,36545450,36545451,36545452,36545527,36545541,36545602,36545639,36545656,36545659,36545671,36545681,36545696,36545709,36545714,36545744,36545752,36545778,36545787,36545848,36545907,36545979,36546025,36546032,36546038,36546046,36546079,36546099,36546121,36546137,36546200,36546239,36546251,36546340,36546363,36546394,36546417,36546418,36546453,36546459,36546475,36546479,36546497,36546507,36546515,36546526,36546528,36546536,36546596,36546602,36546603,36546606,36546632,36546676,36546715,36546716,36546718,36546778,36546784,36546804,36546805,36546826,36546876,36546921,36546926,36546927,36546928,36546960,36546964,36547012,36547051,36547130,36547132,36547137,36547160,36547164,36547177,36547179,36547234,36547278,36547308,36547314,36547345,36547367,36547406,36547435,36547450,36547473,36547489,36547535,36547559,36547620,36547631,36547633,36547659,36547665,36547669,36547719,36547732,36547747,36547809,36547822,36547833,36547949,36547957,36547963,36547988,36548007,36548011,36548068,36548092,36548143,36548152,36548188,36548189,36548210,36548257,36548265,36548275,36548276,36548297,36548301,36548344,36548363,36548395,36548399,36548415,36548424,36548455,36548479,36548488,36548497,36548512,36548519,36548531,36548546,36548598,36548599,36548607,36548629,36548649,36548666,36548753,36548761,36548774,36548786,36548792,36548819,36548827,36548833,36548847,36548858,36548907,36548915,36548916,36548964,36548990,36549006,36549034,36549047,36549049,36549064,36549066,36549094,36549129,36549130,36549135,36549136,36549195,36549226,36549261,36549329,36549354,36549387,36549391,36549394,36549462,36549474,36549517,36549534,36549547,36549577,36549579,36549615,36549620,36549636)
neuropathy <- c(neuropathy, 36549676,36549687,36549697,36549711,36549714,36549783,36549793,36549803,36549805,36549820,36549836,36549860,36549862,36549910,36549935,36549942,36549963,36549965,36549985,36549988,36549990,36550030,36550055,36550075,36550094,36550167,36550217,36550238,36550243,36550246,36550248,36550260,36550291,36550317,36550348,36550361,36550363,36550372,36550393,36550433,36550476,36550490,36550499,36550508,36550509,36550564,36550568,36550594,36550606,36550675,36550676,36550703,36550705,36550720,36550727,36550741,36550750,36550803,36550831,36550962,36550979,36550983,36550991,36550992,36551005,36551006,36551024,36551050,36551090,36551213,36551232,36551259,36551296,36551300,36551306,36551318,36551324,36551446,36551473,36551488,36551525,36551531,36551535,36551536,36551561,36551564,36551565,36551579,36551626,36551636,36551652,36551657,36551658,36551701,36551711,36551731,36551774,36551807,36551812,36551815,36551863,36551968,36551969,36551989,36552004,36552021,36552030,36552040,36552054,36552067,36552073,36552113,36552180,36552195,36552197,36552202,36552207,36552233,36552250,36552253,36552257,36552273,36552287,36552290,36552293,36552318,36552321,36552350,36552369,36552379,36552401,36552404,36552493,36552529,36552558,36552572,36552648,36552658,36552705,36552725,36552750,36552785,36552809,36552825,36552841,36552846,36552863,36552968,36552990,36553036,36553050,36553099,36553109,36553119,36553122,36553167,36553174,36553192,36553206,36553233,36553257,36553266,36553329,36553337,36553408,36553411,36553433,36553440,36553491,36553494,36553515,36553544,36553608,36553610,36553702,36553710,36553728,36553752,36553765)
neuropathy <- c(neuropathy, 36553774,36553829,36553861,36553864,36553866,36553886,36553901,36553904,36553952,36553978,36554014,36554020,36554173,36554182,36554188,36554199,36554206,36554285,36554288,36554289,36554305,36554356,36554361,36554382,36554412,36554413,36554419,36554444,36554476,36554495,36554499,36554529,36554541,36554674,36554735,36554779,36554796,36554818,36554820,36554833,36554865,36554881,36554891,36554899,36554932,36554960,36555033,36555072,36555078,36555084,36555121,36555150,36555219,36555221,36555227,36555232,36555259,36555280,36555281,36555307,36555361,36555392,36555399,36555422,36555425,36555466,36555589,36555604,36555632,36555640,36555642,36555643,36555647,36555670,36555719,36555721,36555734,36555740,36555758,36555808,36555842,36555849,36555852,36555872,36555874,36555878,36555942,36555959,36556064,36556153,36556165,36556166,36556170,36556179,36556217,36556247,36556367,36556438,36556459,36556462,36556499,36556568,36556580,36556584,36556592,36556625,36556654,36556667,36556679,36556681,36556751,36556802,36556808,36556889,36556938,36556952,36556964,36557055,36557118,36557122,36557151,36557159,36557177,36557201,36557211,36557258,36557263,36557285,36557322,36557346,36557385,36557462,36557505,36557540,36557596,36557650,36557665,36557748,36557760,36557770,36557773,36557795,36557843,36557847,36557860,36557875,36557884,36557898,36557931,36557939,36557962,36557964,36557969,36557974,36557992,36558036,36558040,36558041,36558106,36558109,36558126,36558129,36558144,36558159,36558167,36558171,36558177,36558180,36558215,36558217,36558223,36558232,36558249,36558252,36558290,36558318,36558384,36558449,36558465,36558513,36558516,36558518,36558541,36558548,36558586,36558593,36558623,36558677,36558741,36558749,36558777,36558845,36558860,36558871,36558874,36558892,36558913,36558914,36558959,36558982,36558992,36559000,36559014,36559019,36559024,36559047,36559069,36559073,36559109,36559132,36559179,36559190,36559217,36559242,36559284,36559301,36559390,36559391,36559402,36559409,36559412,36559444,36559445,36559491,36559493,36559514,36559517,36559553,36559558,36559564,36559577,36559585,36559589,36559653,36559657,36559709,36559716,36559777,36559788,36559835,36559845,36559884,36559904,36559911,36559918,36559960,36559980,36559995,36560024,36560026,36560030,36560074,36560151,36560174,36560187,36560253,36560259,36560287,36560289,36560300,36560313,36560333,36560339,36560360,36560364,36560393,36560404,36560425,36560426,36560433,36560481,36560491,36560494,36560502,36560523,36560533,36560534,36560598,36560609,36560699,36560701,36560712,36560738,36560778,36560805,36560878,36560895,36560956,36560998,36561014,36561015,36561025,36561057,36561062,36561109,36561115,36561123,36561134,36561135,36561166)
neuropathy <- c(neuropathy, 36561170,36561173,36561232,36561311,36561314,36561335,36561351,36561370,36561374,36561379,36561389,36561421,36561428,36561446,36561459,36561468,36561470,36561494,36561510,36561523,36561564,36561590,36561607,36561642,36561677,36561684,36561725,36561731,36561732,36561742,36561780,36561781,36561820,36561878,36561892,36561895,36561908,36561949,36561950,36561953,36562025,36562045,36562110,36562117,36562127,36562128,36562175,36562181,36562194,36562197,36562204,36562218,36562227,36562228,36562237,36562239,36562252,36562309,36562317,36562357,36562389,36562402,36562413,36562451,36562457,36562467,36562502,36562511,36562517,36562527,36562572,36562607,36562651,36562735,36562743,36562792,36562797,36562874,36562879,36562890,36562895,36562899,36562948,36562972,36562984,36562987,36563034,36563057,36563064,36563087,36563088,36563118,36563121,36563135,36563143,36563215,36563223,36563235,36563241,36563246,36563248,36563254,36563258,36563290,36563364,36563399,36563407,36563432,36563441,36563445,36563459,36563466,36563504,36563515,36563578,36563590,36563625,36563628,36563637,36563674,36563731,36563734,36563739,36563811,36563820,36563892,36563896,36563910,36563926,36563934,36563961,36563968,36563976,36564006,36564037,36564048,36564087,36564221,36564239,36564275,36564351,36564368,36564405,36564419,36564431,36564476,36564493,36564575,36564602,36564615,36564641,36564651,36564742,36564749,36564765,36564767,36564898,36564920,36565016,36565030,36565031,36565035,36565045,36565056,36565107,36565161,36565197,36565207,36565219,36565226,36565230,36565242,36565257,36565299,36565309,36565319,36565426,36565431,36565434,36565467,36565494,36565498,36565508,36565529,36565541,36565563,36565610,36565616,36565630,36565663,36565668,36565725,36565729,36565733,36565735,36565743,36565809,36565814,36565836,36565841,36565881,36565890,36565962,36565993,36565997,36566022,36566026,36566051,36566057,36566062,36566076,36566086,36566096,36566111,36566122,36566182,36566203,36566207,36566210,36566252,36566295,36566325,36566344,36566403,36566417,36566437,36566439,36566458,36566491,36566505,36566507,36566522,36566536,36566537,36566538,36566539,36566547,36566587,36566603,36566608,36566611,36566662,36566679,36566693,36566702,36566726,36566733,36566835,36566855,36566883,36566895,36566914,36566936,36566958,36566965,36567011,36567013,36567015,36567078,36567109,36567115,36567120,36567147,36567175,36567228,36567235,36567263,36567285,36567286,36567312,36567322,36567347,36567351,36567364,36567365,36567376,36567413,36567504,36567510,36567561,36567673,36567733,36567743,36567745,36567771,36567780,36567788)
neuropathy <- c(neuropathy, 36567812,36567827,36567831,36567833,36567850,36567855,36567889,36567893,36567916,36567933,36567942,36567975,36567976,36568084,36568110,36568219,36568256,36568318,36568325,36674513,36674519,36674764,36674787,36674788,36674826,36674867,36674914,36675024,36675026,36675041,36675043,36675060,36675143,36675179,36676493,36676852,36680577,36684203,36684263,36684265,36684423,36684609,36684610,36684651,36684658,36684716,36684724,36684778,36685064,36685117,36685190,36685191,36685261,36685262,36686116,36686117,36686130,36686162,36686268,36686269,36686270,36686271,36686332,36686333,36686936,36686937,36686938,36687008,36687089,36687177,36687189,36687226,36687227,36712849,36712930,36713167,36713483,36713484,36713563,36713608,36714330,36714331,36714332,36714333,36714335,36714547,36714552,36714655,36714663,36714971,36715138,36715333,36715501,36715503,36715518,36715519,36715546,36715671,36715672,36715673,36715674,36715773,36715774,36715775,36715776,36715779,36715838,36716032,36716159,36716264,36716396,36716429,36716493,36716560,36716561,36716599,36716698,36716699,36716804,36716805,36716806,36716901,36716912,36716942,36717015,36717041,36717042,36717085,36717089,36717132,36717151,36717190,36717250,36717345,36717457,36717481,36717573,36717726,37016354,37016648,37016748,37016767,37016768,37017214,37017262,37017429,37017430,37017431,37017432,37017462,37017469,37017537,37017539,37017543,37017545,37017552,37017593,37017608,37017703,37018566,37018714,37018721,37018728,37018918,37018987,37019034,37108904,37108905,37108906,37108959,37108965,37108966,37108968,37108969,37109017,37109018,37109547,37109548,37109673,37109694,37109776,37109793,37109811,37109886,37109887,37110099,37110170,37110337,37110342,37110346,37110506,37110529,37110530,37110531,37110532,37110533,37110534,37110535,37110536,37110537,37110543,37110680,37110681,37110682,37110683,37110720,37110771,37111328,37116362,37116378,37116393,37116696,37116960,37117079,37117236,37117750,37119156,37119157,37203915,37203958,37203960,37204178,37204221,37204229,37204233,37204274,37204276,37204278,37204281,37204369,37204410,37204431,37204432,37204510,37204522,37204541,37204553,37204686,37204831,37205047,37205069,37206118,37207657,37207850,37207860,37207910,37207920,37207971,37207978,37208011,37208012,37208016,37208017,37208021,37208253,37209318,37209319,37209361,37209362,37209437,37209438,37209439,37209443,37209444,37209445,37209555,37209556,37209559,37309618,37309622,37309624,37309668,37310094,37310180,37310181,37310182,37310183,37310184,37310185,37310186,37310187,37310201,37310202,37310203,37310208,37310209,37310572,37310573,37311162,37311163,37311164,37311165,37311495,37311496,37311885,37311886,37311887,37311989)
neuropathy <- c(neuropathy, 37312091,37312156,37312197,37312198,37312218,37312612,37312613,37312614,37312615,37312616,37312738,37395587,37396086,37396221,37396434,37396785,37396786,37397000,37397001,37397002,37397003,37397004,37397005,37397007,37397028,37397207,37397260,37397359,37397457,37397549,37399444,37399460,37399469,37399736,40479564,40481053,40481904,40482511,40483299,40483619,40483696,40483791,40483815,40485984,40486652,40487958,40490353,40492797,40493211,42511642,42511650,42511658,42511663,42511678,42511711,42511715,42511718,42511739,42511774,42511784,42511786,42511814,42511860,42511893,42511908,42511923,42511955,42511973,42512018,42512032,42512036,42512041,42512065,42512090,42512105,42512135,42512160,42512166,42512178,42512217,42512234,42512248,42512253,42512263,42512316,42512322,42512331,42512337,42512358,42512360,42512361,42512368,42512395,42512410,42512412,42512442,42512457,42512466,42512551,42512562,42512582,42512591,42512635,42512636,42512637,42512638,42512651,42512662,42512667,42512686,42512730,42512736,42512737,42512753,42512760,42512763,42512778,42512789,42512792,42512798,42512814,42512818,42512850,42512865,42512907,42512940,42512985,42514460,42514461,42514462,42514463,42514464,42534978,42535095,42535099,42535101,42535102,42535116,42535117,42535118,42535151,42535152,42535153,42535154,42535155,42535156,42535188,42535189,42535190,42535194,42535195,42535196,42535197,42535198,42535199,42535217,42535218,42535219,42535220,42535221,42535222,42535223,42535225,42535408,42535409,42535430,42535431,42535432,42535433,42535434,42535435,42535436,42535437,42535438,42535439,42535440,42535441,42535442,42535443,42535446,42535447,42535448,42535449,42535451,42535452,42535455,42535462,42535463,42535464,42535469,42535470,42535471,42535472,42535513,42535514,42535515,42535519,42535520,42535522,42535526,42535527,42535539,42536258,42536259,42536260,42536697,42536756,42536757,42536758,42536759,42536760,42536761,42536881,42537442,42537550,42537669,42537705,42537706,42538614,42538615,42538616,42538791,42538839,42538840,42539164,42539169,42539187,42539188,42539198,42539208,42539216,42539252,42539253,42539258,42539264,42539273,42539275,42539277,42539280,42539285,42539474,42572862,42596478,42596648,42596652,42596653,42597080,42597201,42598759,42599606,42600400,42710044,43020789,43020790,43530607,43530618,43530689,43530705,43530707,43530713,43530726,43530756,43530862,43530983,43530984,43531026,43531027,43531028,43531029,43531030,43531033,43531034,43531035,43531039,43531047,43531048,43531074,43531075,43531077,43531078,43531175,43531560,43531561,43531563,43531649,43531652,43531654,43531692,44499406,44499600,44499602,44499656,44499663,44499822,44499851,44499914,44500169,44500172,44500222,44500319,44500621,44500670,44500908,44500957,44501050,44501300,44501375,44501688,44501755,44501986,44501991,44502070,44502197,44502257,44502413,44502672,44503184,44503351,44503352,44782526,44782794,44782795,44782796,44783024,44783025,44783026,44783143,44783201,44783202,44783873,44783874,44784628,44805212,44809714,45757202,45757236,45757257,45757271,45757278,45765490,45765491,45766388,45768456,45769830,45769894,45770924,45773567,46269858,46270109,46270482,46271082,46271103,46271104,46271105,46271149,46271211,46271378,46271935,46272050,46272057,46272058,46272059,46272949,46273207,46273291,46273297,46273298,46274079)

resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% neuropathy) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: Neuropathy"

# Medical history: Nephropathy
nephropathy <- c(196455,196464,197035,197253,197320,197329,259070,432961,435003,435308,435320,444044,761083,762464,3180351,3180540,3189598,3654660,3661748,4027117,4030519,4030671,4031999,4032295,4032296,4032298,4042397,4054915,4054992,4056023,4056472,4056473,4056474,4056475,4058837,4058985,4058986,4058988,4058989,4058990,4058991,4059454,4059455,4059456,4059457,4059458,4066005,4066405,4070939,4100954,4102631,4111399,4119093,4125953,4125957,4125968,4125969,4125971,4126112,4126131,4126300,4126301,4126305,4126424,4126426,4126427,4126439,4127550,4127551,4128029,4128067,4128371,4137752,4139414,4139915,4143190,4149888,4151112,4152839,4159967,4160274,4173196,4180453,4181114,4188623,4189531,4190190,4195297,4200639,4210158,4215648,4219863,4220051,4228827,4232873,4234761,4239213,4242411,4251796,4264681,4265212,4267646,4272470,4272486,4280571,4284491,4284564,4286024,4302298,4303512,4306513,4308408,4310661,4311129,4329572,4343933,36716182,36716183,36716312,36716946,36717581,37016360,37016366,37018343,37018344,37018345,37019162,37111531,37116430,37116431,37116432,37116834,37208344,37312165,37395514,37395516,37395517,37395518,37395519,37395520,37395521,37399017,40481064,40481595,40482881,43530914,43530928,43530935,44808128,44808338,44808340,44808744,44808821,44808822,44808823,44809061,44809062,44809063,44809170,44809173,44809286,44813789,44813790,45757398,45757442,45757466,45757746,45765710,45772126)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% nephropathy) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: Nephropathy"

# Medical history: ACS + angina
acsangina <- c(312327,315296,315830,315832,319039,321318,434376,436706,438170,438438,438447,441579,444406,761735,761736,761737,3654465,3654466,3654467,3655133,3661502,3661503,3661504,3661520,3661524,3661547,3661641,3661642,3661643,3661644,3661645,3661646,4051874,4068938,4078531,4108669,4108670,4116486,4119455,4119456,4119457,4119942,4119943,4119944,4119945,4119946,4119947,4119948,4121464,4121465,4121466,4124684,4124685,4126801,4145721,4151046,4155008,4155009,4155963,4161456,4161457,4161973,4161974,4178129,4184827,4198141,4201629,4231426,4243372,4262446,4264145,4267568,4270024,4275436,4296653,4303359,4310270,4324413,4324893,35610091,35610093,35611570,35611571,35615052,35615053,36712982,36712983,36712984,37209632,37309713,43020460,43531588,44782712,44782769,45766075,45766076,45766115,45766116,45766150,45766151,45771322,46270158,46270159,46270160,46270161,46270162,46270163,46270164,46273495,46274044)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% acsangina) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "History of atherosclerotic vascular disease: coronary "

# Medical history: Nonhemorrhagic stroke 
ich <- c(372435,377254,379778,443454,443790,443864,444091,761110,762933,762934,762935,762937,762951,763015,765515,3179950,3184775,3185378,3188164,4031045,4043731,4043732,4045735,4045737,4045738,4045740,4045741,4046089,4046090,4046237,4046358,4046359,4046360,4046361,4046362,4048784,4077086,4108356,4110189,4110190,4110192,4111714,4119140,4129534,4131383,4138327,4141405,4142739,4145897,4146185,4298750,4319146,35610084,35610085,36717605,37110678,37110679,37116473,37395562,40479572,42535465,42535466,42535523,42535524,43530683,43531607,44782773,45767658,45772786,46270031,46270380,46270381,46273649)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% ich) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "History of atherosclerotic vascular disease: cerebrovascular"

# Medical history: peripheral arterial disease
pvd <- c(134380,192657,195834,200132,314965,315558,317309,318712,321052,321822,434961,439836,441044,443407,443408,443729,444264,760869,760870,760871,761206,761428,761429,761430,761431,761432,761433,761434,761463,761464,761465,761466,761467,761740,761741,761742,761743,761744,761748,761749,761804,761805,761812,761813,761814,761815,761816,761822,761823,761824,761825,761826,761827,761828,761829,761853,761854,761858,762053,764026,765079,765080,765226,765284,765300,765301,3171253,3173537,3173780,3176677,3176693,3181089,3184873,3192767,3198350,3654996,4025854,4030663,4033350,4055025,4055720,4108375,4108376,4108377,4108380,4108381,4110331,4110333,4111848,4111850,4112161,4112162,4114011,4115229,4116977,4117679,4117933,4118795,4119141,4119612,4119614,4120098,4121625,4121626,4121627,4124836,4124837,4124838,4124839,4127997,4131908,4136335,4137550,4137551,4139534,4139577,4139578,4139579,4140616,4141106,4141975,4143588,4146012,4151848,4153293,4168060,4173167,4174012,4174013,4174014,4174015,4175569,4175570,4178399,4178400,4178609,4179907,4179908,4179909,4179910,4182191,4193056,4193057,4193302,4194886,4195971,4195972,4195973,4199183,4199887,4200875,4202511,4208071,4208072,4208809,4208944,4226026,4231816,4231826,4235591,4236905,4246643,4253510,4263089,4263648,4264734,4289307,4291464,4294425,4299117,4299127,4301022,4301023,4301024,4316367,4318843,4329498,4337367,4341646,4348039,4348319,35611566,35615018,35615019,35615020,35615021,35615028,35615036,35615054,35615061,35615062,35615063,35615071,35615073,35615075,35615076,35615080,35615081,35615082,35615083,35615086,35615087,35615088,35615089,35615090,35615091,35615092,35615093,35615094,35615095,35615096,35615097,35615098,35615099,35615100,35615106,35615107,35615116,36712805,36712807,36712955,36712987,36713012,36713013,36713014,36713015,36713094,36717256,37016147,37017533,37109921,37109923,37110250,37110251,37116421,37116422,37209668,37312530,40483538,40484541,40484551,40484912,42535143,42535335,42535829,42536634,42536636,42539410,42572961,42597028,42597030,42599607,42599802,42599894,43020443,43021846,43022064,44782775,44782819,44808745,44808746,44808747,44808832,44808833,44813802,44813823,46271459,46271460,46271462)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% pvd) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "History of atherosclerotic vascular disease: peripheral"

# Medical history: History of atherosclerotic vascular disease: any
anyathero <- c(acsangina, ich, pvd)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% anyathero) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "History of atherosclerotic vascular disease: any"

# Medical history: History of CVD
cvd <- c(313217, 381591, 317576, 321588, 316139, 4185932, 321052, 440417, 444247)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% cvd) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical history: History of CVD"

# Medical history: History of amputation
amputation <- c(75112,79957,198287,198594,198900,200877,432762,438598,443917,443982,444073,760806,765371,4050383,4050385,4050387,4050389,4051294,4051298,4051439,4051440,4053123,4053124,4053125,4053126,4053127,4053128,4053149,4054066,4056290,4056291,4056293,4056294,4056297,4056298,4056434,4056435,4096480,4148693,4195268,4198759,4231695,4308552,4309488,4318111,4319151,4319152,4320023,4320024,4320025,37110644,37116498,37116542,37116543,37119238,37119300,40483816,42536713,42536714,42536847,42538749,44806489,44807046, 764236,764237,764238,765624,2006242,2006243,2104950,2105209,2105210,2105211,2105222,2105223,2105446,2105447,2105448,2105449,2105450,2105451,2105804,2105805,2105806,2105807,2105808,2719984,2719985,2719994,3168091,3173821,3174572,3181155,3182628,3187877,4002166,4008397,4018719,4020884,4034325,4034326,4034551,4035764,4053140,4054498,4054983,4062385,4067621,4078563,4080100,4083397,4083398,4108565,4108567,4119910,4143795,4143796,4143797,4146410,4159766,4169822,4177620,4183102,4195136,4217266,4218050,4219032,4226945,4227157,4234959,4242396,4246689,4246691,4264278,4264289,4264290,4264716,4272232,4287928,4302020,4338257,35622529,36674416,36674417,36715395,36715396,36715397,36717437,37109581,37109582,37109822,37109845,37109850,37109895,37115742,37115743,37116276,37118034,37118455,37204044,37206818,37206819,37206860,40479688,44515920,44515922,44515928,44515930,44515932)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% amputation) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical history: History of CVD"

# BMI 
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 40762636)))

# Systolic blood pressure  mm Hg
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3004249)))

# Diastolic blood pressure  mm Hg
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3012888)))

# glycated hemoglobin
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3004410)))

# 	Cholesterol [Mass/volume] in Serum or Plasma	
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3027114)))

# 	Cholesterol in HDL [Mass/volume] in Serum or Plasma	
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3007070)))

# 	Cholesterol in LDL [Mass/volume] in Serum or Plasma	
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3028437)))

#	Triglyceride [Mass/volume] in Serum or Plasma
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3022192)))

#EGFR
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3029859))[1,])

#Median albumin-to-creatinine ratio
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3027108))[1,])

# Normoalbuminuria
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %like% 3027108, covariateValue < 30) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Normoalbuminuria"

# Microalbuminuria
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %like% 3027108, covariateValue >= 30, covariateValue <300) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Microalbuminuria"

# Renal function, creatinine clearance
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %like% 3027108, covariateValue >= 300) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Macroalbuminuria"

# final
resultTablePooledOE <- resultTablePooled

#########################
### Indication cohrot ###
#########################
tc <- tcList[idx[2],c(1,2)]
targetNumber <- tc[1,1]
comparatorNumber <- tc[1,2]
targetCohort <- cohort$cohort %>% filter(.data$COHORT_DEFINITION_ID == targetNumber) %>% mutate(treatment = 1)
comparatorCohort <- cohort$cohort %>% filter(COHORT_DEFINITION_ID == comparatorNumber) %>% mutate(treatment = 0)
population <- targetCohort %>% union(comparatorCohort)
population <- rename(population, rowId = SUBJECT_ID)

sizeOI <- data.frame(treatment = -1, n = population %>% summarise(n = n_distinct(.data$rowId)))
sizeOI <- rbind(sizeOI, data.frame(population %>% group_by(.data$treatment) %>% tally()))

covariateSettings <- createCovariateSettings(useDemographicsGender = TRUE,
                                             useDemographicsAge = TRUE,
                                             useDemographicsRace = TRUE,
                                             useMeasurementValueAnyTimePrior = TRUE,
                                             useDrugGroupEraLongTerm = TRUE,
                                             useConditionGroupEraLongTerm = TRUE,
                                             useProcedureOccurrenceLongTerm = TRUE)

covariates <- getDbCovariateData(connectionDetails = connectionDetails,
                                 cdmDatabaseSchema = cdmDatabaseSchema,
                                 cohortDatabaseSchema = cohortDatabaseSchema,
                                 cohortTable = cohortTable,
                                 cohortId = c(targetNumber, comparatorNumber),
                                 covariateSettings = covariateSettings)

covariates$covariates <- covariates$covariates %>% left_join(population, by=("rowId"), copy = TRUE)
covariates$covariates <- covariates$covariates %>% left_join(covariates$covariateRef)

statisticsPooled <- covariates$covariates %>%
  group_by(.data$conceptId) %>%
  summarise(sum = sum(as.numeric(.data$covariateValue), na.rm = TRUE),
            mean = mean(as.numeric(.data$covariateValue), na.rm = TRUE),
            sumSqr = sum(as.numeric(.data$covariateValue)^2, na.rm = TRUE),
            median = median(as.numeric(.data$covariateValue), na.rm = TRUE),
            n = n(),
            min = min(as.numeric(.data$covariateValue), na.rm = TRUE),
            max = max(as.numeric(.data$covariateValue), na.rm = TRUE)) %>%
  mutate(sd = sqrt(abs(.data$sumSqr - .data$mean^2))) 

statisticsPooled <- statisticsPooled %>% left_join(covariates$covariateRef) 
statisticsPooled <- statisticsPooled %>% left_join(select(covariates$analysisRef, analysisId, isBinary), by=("analysisId"))

# Result for CANVAS trial
resultTablePooled <- data.frame()

# Mean age
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter (covariateId == 1002)))

# Female
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter (covariateId == 8532001)))

# Hypertension
hpt <- c(132685,134414,135601,136743,136760,137940,141084,141639,192684,197930,200157,201912,312648,314090,314103,314423,314958,316866,317895,317898,318437,319826,320128,320456,321074,321080,321638,433536,438490,439077,439393,441922,443771,762994,3169253,3191244,3656115,4006325,4023318,4028741,4028951,4032952,4034031,4034094,4034095,4035655,4048212,4049389,4057976,4057978,4057979,4058987,4061667,4062550,4062811,4062906,4071202,4080325,4083723,4094374,4108213,4110947,4110948,4118910,4146627,4146816,4148205,4151903,4159755,4162306,4167358,4167493,4174979,4178312,4179379,4180283,4199306,4209293,4212496,4215640,4217486,4218088,4219323,4221991,4227607,4242878,4249016,4253928,4262182,4263067,4269358,4276511,4277110,4279525,4283352,4289142,4289933,4291933,4302591,4304837,4305599,4311246,4316372,4321603,4322735,35622939,35624277,36713024,36715087,37016726,37208172,37208293,40481896,42538697,42538946,42873163,43020424,43021830,44783643,44783644,44784483,44784484,44809026,44809027,44809548,44809569,44811110,44811932,44811933,45757119,45757137,45757356,45757444,45757445,45757446,45757447,45757787,45757788,45768449,45771064,45771067)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% hpt) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: Hypertension"

# Medical history: CHF
chf <- c(314378,316994,319835,439694,439696,439698,762002,762003,764874,4023479,4139864,4142561,4206009,4215446,4229440,4242669,4284562,4327205,36712927,36712928,36713488,37309625,43021825,43021826,43022068,44782428,44782655,44782713,44782728,44784345,44784442)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% chf) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: Congestive Heart Failure"

# Medical history: retinopathy
retinopathy <- c(376114,376683,377552,378743,380096,380097,761053,765373,3655235,3655913,3655914,3655948,3656194,3656195,4101478,4105172,4105173,4151453,4161670,4161671,4162095,4164174,4164175,4164176,4164632,4174977,4195043,4195044,4195498,4199039,4209538,4210128,4210129,4210872,4210874,4212441,4215961,4218499,4221344,4221962,4223463,4226121,4227210,4235260,4247107,4252356,4255399,4255400,4255401,4266041,4266042,4266637,4269870,4269871,4290822,4290823,4334884,4336000,4338900,4338901,35626036,35626037,35626038,35626039,35626041,35626042,35626043,35626044,35626046,35626047,35626067,35626068,35626069,35626070,35626071,35626072,35626087,35626088,35626764,35626904,35626905,36674199,36674200,36674752,36674753,36674765,36674766,37016179,37016180,37016356,37016357,37016358,37311253,37311254,37311832,37311833,43530656,43530685,44805628,45757065,45757073,45757075,45757266,45757435,45763583,45763584,45769873,45770830,45770831,45770881,45770928,45770986,45773064)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% retinopathy) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: retinopathy"

# Medical history: Neuropathy

neuropathy <- c(74635,75949,76396,76685,76831,78647,78937,79212,81195,81400,81425,133646,134331,136865,137548,137858,138148,138612,138682,138936,140090,141004,142033,192239,192885,193079,193186,194149,194913,195259,196307,197042,197089,197608,197852,197857,199086,200611,200644,372309,372409,372828,372888,372914,372915,372999,373082,373101,373190,373206,373470,373487,373488,373497,374027,374032,374221,374360,374912,374923,374925,374954,375260,375428,375458,375631,375716,375806,375823,376028,376112,376395,376686,376963,376989,377271,377565,377570,377680,377789,378135,378140,378420,378421,378439,378686,378741,379801,379818,380030,380094,380265,380394,380398,380410,380729,380995,381009,381312,381504,381551,381572,381732,381733,381861,381952,382014,382034,432307,432893,433480,433642,433916,433975,434530,434824,434929,435138,435253,435269,435537,435701,435803,436684,436702,436806,436936,437161,437262,437496,437543,437547,437763,437876,438155,438961,439211,439308,439807,439842,440703,440890,440893,441479,441564,441845,441848,442305,442529,443225,443450,443606,443776,444123,444214,444218,444263,444382,751708,760127,760892,760893,760908,760909,760925,760979,761121,761122,761217,761320,761321,761328,761329,761346,761347,761377,761378,761521,761522,761523,761524,761525,761526,761527,761528,761529,761634,761635,761845,761846,761847,761848,761849,761850,761859,761860,761866,761867,761868,761869,761870,761871,761884,761934,761987,762067,762069,762070,762071,762072,762073,762074,762075,762076,762077,762078,762079,762100,762101,762102,762103,762104,762107,762108,762109,762110,762111,762112,762113,762114,762115,762116,762117,762118,762120,762121,762122,762123,762125,762126,762127,762128,762129,762131,762132,762133,762134,762135,762136,762137,762138,762139,762142,762143,762144,762145,762146,762150,762151,762156,762280,762346,762347,762352,762353,762355,762356,762831,763930,764593,764917,764965,765022,765027,765042,765085,765086,765127,765128,765139,765140,765141,765142,765147,765148,765235,765318,765419,765472,765473,765474,765485,765486,765650,1552972,1553049,1553059,1553070,1553078,1553098,1553103,1553113,1553138,1553151,1553183,1553245,1553296,1553297,1553351,1553360,1553368,1553388,1553392,1553397,1553431,1553433,1553442,1553449,1553453,1553462,1553504,1553507,1553511,1553519,1553531,1553532,1553548,1553556,1553565,1553581,1553588,1553591,3170099,3171310,3172374,3173531,3174623,3174710,3174862,3176403,3177327,3177449,3178878,3178922,3182576,3184100,3184959,3185305,3186860,3192039,3654615,3654627,3654628,3654629,3654630,3654632,3654638,3654652,3654654,3654655,3654664,3654670,3654884,3654915,3654917,3655188,3655277,3655278,3655279,3655280,3655281,3655282,3655283,3655284,3655340,3655341,3655374,3655583,3655603,3655604,3655617,3655624,3655625,3655626,3655627,3655628,3655630,3655660,3655667,3655670,3655822,3655823,3655824,3655825,3655844,3655846,3655870,3657084,3657085,3657135,3657146,3657796,3657808,3657809,3657810,3657841,3657842,3657878,3657879,3657880,4000958,4001318,4001319,4001320,4001321,4001322,4001450,4002030,4002173,4002341,4002342,4002343,4002344,4002345,4002346,4002348,4002349,4002350,4002351,4002352,4002353,4002470,4003173,4003174,4003175,4003176,4003177,4003178,4003179,4003694,4003826,4003827,4005774,4005775,4006988,4008510,4009037,4009555,4009644,4010074,4013309,4013312,4014938,4017394,4017951,4018085,4023792,4024519,4025822,4027372,4027396,4027533,4027537,4027538,4027732,4028085,4028086,4029117,4029646,4029822,4030066,4030590,4030591,4030592,4030598,4030737,4031719,4031720,4032347,4032348,4032800,4033872,4042414,4043401,4043566,4043573,4043574,4043575,4043576,4043577,4043579,4043580,4043581,4043672,4043673,4043711,4043712,4043713,4043714,4043716,4043717,4043718,4043719,4043720,4043721,4043722,4043723,4043725,4043726,4043727,4043729,4043730,4043889,4043890,4043891,4043912,4044021,4044073,4044075,4044244,4044245,4044247,4044248,4044249,4044254,4044255,4044351,4044384,4044385,4044386,4044388,4044390,4044391,4044392,4044393)
neuropathy <- c(neuropathy, 4044394,4044396,4044397,4044398,4044399,4044401,4044402,4044403,4044404,4044405,4044407,4044408,4044409,4044411,4044412,4045630,4045631,4045632,4045633,4045724,4045725,4045727,4045728,4045729,4045730,4045731,4045732,4045968,4046240,4046241,4046242,4046330,4046331,4046332,4046335,4046336,4046338,4046339,4046340,4046341,4046342,4046343,4046344,4046346,4046347,4046348,4046349,4046350,4046351,4046353,4046354,4046355,4046356,4046357,4046908,4047760,4047859,4047862,4047883,4047884,4047917,4047918,4048016,4048017,4048018,4048020,4048022,4048023,4048024,4048025,4048027,4048028,4048029,4048030,4048031,4048032,4048033,4048035,4048036,4048037,4048038,4048039,4048040,4048041,4048043,4048044,4048045,4048046,4048047,4048048,4048049,4048050,4048061,4048157,4048435,4048653,4048654,4048655,4048656,4048740,4048779,4048780,4048782,4049810,4050856,4050964,4053308,4054754,4054762,4054763,4054765,4054766,4054767,4054768,4054769,4054770,4054771,4054772,4054773,4054774,4054812,4054852,4054853,4054854,4054855,4054856,4054857,4054859,4054860,4054861,4054862,4054864,4054865,4054866,4054867,4054868,4054869,4054870,4054872,4054873,4054878,4054879,4055222,4055468,4055855,4056885,4056886,4056887,4056889,4056890,4056891,4056892,4056893,4056894,4056895,4056898,4056899,4056900,4056901,4056902,4057017,4057018,4057019,4057020,4057022,4057023,4057027,4057028,4057029,4057030,4057031,4057032,4057033,4057035,4057036,4057037,4057038,4058948,4058953,4058956,4058957,4058958,4058959,4058960,4058961,4058962,4058963,4058964,4058965,4058966,4059086,4059088,4059090,4059091,4059092,4059094,4059095,4059096,4059097,4059098,4059100,4059101,4059102,4059103,4059104,4059105,4059106,4059107,4059108,4059109,4059110,4059112,4059113,4059115,4059116,4062108,4062109,4062110,4062111,4062221,4062222,4062224,4062225,4062226,4062227,4062228,4062229,4062230,4062231,4062232,4062233,4062234,4062235,4062236,4062238,4062239,4062240,4062242,4062243,4062244,4062245,4062246,4062456,4062477,4062566,4062577,4062581,4062844,4062845,4063207,4063208,4063211,4067531,4067933,4068009,4068023,4068111,4068476,4068477,4068617,4069195,4069205,4070527,4070552,4071154,4071164,4071499,4077819,4078976,4078977,4079019,4079325,4080134,4080146,4080337,4080382,4081178,4081219,4082016,4082017,4082271,4082299,4082302,4082768,4082774,4083777,4085741,4086178,4086317,4087081,4087805,4090560,4091559,4091621,4092713,4094260,4094261,4094262,4094959,4094960,4094961,4094962,4094964,4095302,4095429,4095536,4095537,4095538,4095539,4095540,4095542,4095543,4095544,4095892,4096003,4096004,4096005,4096006,4096007,4096628,4096629,4096630,4096632,4096633,4096634,4097283,4097284,4098118,4099985,4099986,4100902,4100903,4101333,4101567,4101880,4101885,4101886,4101887,4101891,4101892,4101893,4101894,4101895,4101898,4102093,4102342,4102360,4102481,4102485,4102492,4102493,4102494,4102498,4102732,4103124,4103235,4103776,4104196,4104844,4104845,4104850,4105005,4105009,4105014,4105016,4105017,4105018,4105020,4105021,4105341,4105632,4105633,4105637,4105639,4105640,4105642,4105643,4106172,4106554,4107377,4109232,4109393,4110655,4110889,4110890,4111031,4111033,4112480,4112481,4112968,4112970,4112971,4112972,4112973,4112974,4114346,4114427,4116215,4116216,4116217,4116572,4116573,4116574,4116861,4117355,4117779,4119333,4120317,4121325,4121336,4121337,4125693,4129225,4130042,4130043,4130044,4130045,4130046,4130047,4130048,4130049,4130051,4130052)
neuropathy <- c(neuropathy, 4130544,4130545,4130661,4130662,4130859,4131025,4131106,4131107,4131109,4131110,4131111,4131117,4131651,4131769,4131773,4131774,4131775,4131776,4131778,4131779,4131780,4131946,4134121,4134122,4134123,4134432,4134434,4134435,4134455,4134456,4134578,4134579,4134580,4134605,4135454,4136547,4136548,4136549,4136977,4137352,4137353,4138332,4138486,4139215,4139780,4140466,4142399,4143237,4143360,4143363,4143857,4143862,4143863,4144833,4144942,4144949,4146840,4147504,4147643,4149325,4150993,4151147,4151196,4151197,4151210,4151221,4151222,4151223,4151224,4151226,4151227,4151453,4151978,4151979,4151980,4151992,4151993,4152299,4152300,4152336,4152403,4152405,4152559,4152601,4154172,4154173,4154174,4154285,4154286,4156050,4160056,4160362,4160436,4160896,4161284,4161285,4161309,4161817,4161823,4162241,4162701,4164292,4164436,4164604,4164770,4165746,4166067,4169073,4170714,4171706,4172489,4172528,4173311,4173826,4174262,4174405,4174699,4175202,4175440,4176139,4176925,4177338,4177483,4177506,4177633,4177634,4177635,4177637,4177993,4178773,4178975,4180912,4181181,4181748,4181849,4181888,4182422,4182543,4182965,4182966,4183120,4183121,4183122,4183124,4183297,4184946,4185022,4185023,4185083,4185598,4187079,4187326,4187806,4188350,4188610,4189184,4189235,4189646,4189667,4190334,4190712,4190744,4191611,4193776,4194060,4194629)
neuropathy <- c(neuropathy, 4194800,4194827,4194878,4194970,4195005,4195055,4196109,4196227,4196252,4196277,4197058,4197114,4197570,4199517,4199740,4200647,4200854,4201143,4202065,4202381,4202652,4204694,4206139,4208028,4208207,4208208,4208987,4209280,4209749,4210321,4211961,4212083,4212449,4215003,4215344,4215954,4216000,4216397,4217060,4218724,4218753,4219507,4219543,4219977,4220079,4220165,4220673,4221637,4221837,4221916,4222415,4223942,4224011,4224242,4225055,4225278,4225528,4226662,4226864,4227072,4227519,4227617,4228419,4228745,4229396,4229405,4230363,4231315,4231893,4232789,4234742,4235717,4237144,4237155,4237198,4237315,4238686,4239243,4239725,4239870,4239889,4240232,4240908,4241035,4241532,4241662,4242345,4242528,4242743,4242811,4242812,4242813,4242834,4242858,4242978,4242979,4243451,4243644,4243770,4244092,4244491,4245501,4245986,4246013,4246029,4246042,4246080,4246137,4246246,4246247,4246248,4246923,4247334,4247716,4247829,4247847,4248131,4248189,4248190,4248551,4249573,4251046,4252861,4253627,4253668,4259501,4259502,4260193,4260823,4262282,4263090,4264613,4264853,4264920,4265579,4265860,4266036,4268260,4268878,4268973,4270614,4271311,4271570,4271598,4272636,4274480,4275414,4275445,4275753,4280953,4282137,4282476,4283669,4286352,4289591,4292056,4292064,4292375,4294272,4295312,4295340,4295421,4296728,4298153,4300531,4300679,4301699,4303516,4304701,4305174,4305334,4307319,4307553,4307721,4307728,4307729,4308142,4308256,4308406,4308632,4308780,4309193,4309357,4309914,4310159,4311158,4311493,4311539,4311625,4311630,4311631,4311706,4311708,4311957,4312039,4312426,4312559,4312924,4312937,4312946,4312956,4313085,4313218,4313232,4313233,4313354,4313379,4313439,4313505,4313507,4313653,4313879,4314002,4314070,4314496,4315532,4315939,4316209,4316382,4316747,4317132,4317564,4317828,4317967,4317989,4318100,4318525,4318562,4318677,4318678,4318703,4318869,4319256,4319437,4319472,4319608,4320696,4322033,4322638,4322891,4323048,4327957,4328334,4328365,4328422,4328943,4329158,4335337,4336520,4336813,4337830,4338235,4338900,4338904,4345229,4347542,4347543,4348435,35607977,35608085,35608120,35610241,35610439,35621928,35621979,35622040,35622286,35622356,35622507,35622694,35623047,35623634,35624130,35624152,35624271,35624321,35624758,35625841,35625847,35625955,35626761,35626762,35626765,36402561,36403094,36403098,36403100,36403135,36403136,36403158,36517203,36517204,36517205,36517227,36517229,36517250,36517282,36517306,36517311,36517347,36517350,36517357,36517382,36517403,36517418,36517423,36517449,36517452,36517539,36517540,36517576,36517579,36517661,36517681,36517692,36517702,36517726,36517756,36517765,36517773,36517790,36517794,36517805,36517818,36517848,36517961,36518006,36518007,36518086)
neuropathy <- c(neuropathy, 36518097,36518137,36518176,36518193,36518209,36518257,36518299,36518327,36518350,36518359,36518360,36518409,36518480,36518501,36518513,36518523,36518533,36518552,36518553,36518581,36518598,36518607,36518619,36518635,36518663,36518701,36518704,36518735,36518764,36518769,36518774,36518788,36518798,36518821,36518846,36518857,36518879,36518881,36518885,36518954,36518969,36518995,36519000,36519015,36519046,36519048,36519068,36519111,36519117,36519143,36519144,36519145,36519154,36519203,36519217,36519219,36519327,36519347,36519424,36519454,36519578,36519593,36519611,36519678,36519682,36519698,36519714,36519715,36519782,36519784,36519788,36519791,36519837,36519894,36519911,36519973,36519994,36520013,36520035,36520036,36520042,36520103,36520131,36520145,36520161,36520240,36520274,36520300,36520303,36520306,36520307,36520323,36520328,36520423,36520476,36520484,36520505,36520511,36520521,36520560,36520585,36520591,36520607,36520621,36520639,36520663,36520665,36520672,36520732,36520745,36520845,36520885,36521019,36521043,36521054,36521062,36521087,36521089,36521091,36521148,36521152,36521169,36521186,36521207,36521251,36521253,36521257,36521284,36521359,36521366,36521403,36521413,36521452,36521462,36521464,36521507,36521530,36521585,36521622,36521635,36521642,36521643,36521673,36521676,36521698,36521765,36521827,36521845,36521928,36521945,36521949,36521969,36521992,36522094,36522096,36522105,36522137,36522150,36522192,36522196,36522303,36522320,36522329,36522356,36522363,36522364,36522423,36522440,36522452,36522473,36522505,36522522,36522558,36522577,36522614,36522628,36522635,36522647,36522698,36522734,36522764,36522798,36522801,36522805,36522821,36522824,36522870,36522872,36522885,36522888,36522906,36522916,36522941,36522958,36523025,36523038,36523056,36523067,36523097,36523102,36523105,36523193,36523227,36523229,36523330,36523337,36523339,36523344,36523374,36523392,36523407,36523420,36523442,36523468,36523483,36523489,36523498,36523525,36523530,36523548,36523557,36523622,36523635,36523756,36523763,36523767,36523807,36523823,36523846,36523877,36523891,36523906,36523912,36523936,36523956,36523975,36524000,36524006,36524021,36524039,36524044,36524064,36524066,36524176,36524180,36524223,36524231,36524291,36524320,36524424,36524468,36524475,36524490,36524494,36524499,36524519,36524563,36524583,36524584,36524601,36524608,36524618,36524640,36524653,36524660,36524729,36524738,36524749,36524797,36524845,36524851,36524887,36524891,36524923,36524986,36525008,36525009,36525020,36525056,36525073,36525108,36525109,36525145,36525162,36525167,36525226,36525230,36525273,36525299,36525318,36525322,36525323,36525411,36525439,36525445,36525460,36525485,36525492,36525521,36525532,36525566,36525577,36525595,36525652,36525704,36525710,36525735,36525781,36525817,36525897,36525927,36525931,36525983,36525984,36525994,36526045,36526108,36526128,36526141,36526144,36526217,36526221,36526255,36526257,36526268,36526277,36526306,36526319,36526339,36526431,36526435,36526443,36526450,36526481,36526483,36526519,36526528,36526532,36526537,36526550,36526565,36526577,36526588,36526618,36526635,36526657,36526665,36526677)
neuropathy <- c(neuropathy, 36526698,36526706,36526712,36526757,36526759,36526767,36526798,36526801,36526816,36526828,36526853,36526868,36526885,36526886,36526889,36526959,36527015,36527096,36527098,36527182,36527247,36527312,36527317,36527320,36527323,36527332,36527337,36527367,36527376,36527454,36527484,36527489,36527492,36527550,36527592,36527602,36527661,36527664,36527690,36527763,36527771,36527836,36527837,36527840,36527843,36527888,36527908,36527918,36527942,36527969,36527988,36527989,36527991,36528000,36528006,36528054,36528055,36528062,36528072,36528101,36528107,36528112,36528155,36528175,36528190,36528197,36528199,36528214,36528237,36528272,36528289,36528394,36528486,36528488,36528494,36528502,36528509,36528523,36528534,36528554,36528561,36528606,36528663,36528667,36528713,36528730,36528742,36528805,36528816,36528827,36528864,36528867,36528869,36528990,36529029,36529036,36529047,36529076,36529085,36529094,36529106,36529136,36529142,36529143,36529146,36529157,36529176,36529187,36529204,36529209,36529216,36529219,36529245,36529318,36529351,36529377,36529390,36529448,36529492,36529512,36529543,36529571,36529637,36529642,36529677,36529754,36529771,36529789,36529821,36529842,36529873,36529875,36529886,36529895,36529903,36529909,36530048,36530084,36530131,36530181,36530201,36530292,36530294,36530326,36530424,36530445,36530494,36530497,36530506,36530523,36530626,36530634,36530635,36530637,36530643,36530700,36530743,36530749,36530862,36530866,36530894,36530901,36530942,36530963,36530986,36531021,36531026,36531027,36531032,36531038,36531045,36531050,36531064,36531082,36531086,36531093,36531096,36531142,36531157,36531229,36531266,36531327,36531412,36531437,36531449,36531460,36531480,36531495,36531497,36531502,36531517,36531537,36531540,36531561,36531571,36531597,36531608,36531621,36531649,36531654,36531662,36531674,36531686,36531697,36531748,36531759,36531771,36531792,36531843,36531895,36531916,36531917,36531920,36531936,36531982,36531983,36531985,36531990,36532051,36532084,36532110,36532113,36532147,36532152,36532221,36532225,36532250,36532263,36532273,36532296,36532300,36532324,36532440,36532466,36532468,36532484,36532526,36532547,36532570,36532571,36532573,36532582,36532617,36532644,36532649,36532657,36532662,36532712,36532765,36532775,36532830,36532860,36532862,36532870,36532913,36532939,36532950,36532985,36532992,36533008,36533034,36533053,36533161,36533171,36533180,36533219,36533263,36533279,36533288,36533306,36533320,36533329)
neuropathy <- c(neuropathy, 36533374,36533383,36533423,36533465,36533474,36533530,36533556,36533591,36533603,36533619,36533620,36533635,36533637,36533669,36533670,36533679,36533762,36533776,36533819,36533838,36533870,36533872,36533905,36533927,36533973,36534028,36534049,36534064,36534065,36534080,36534089,36534101,36534113,36534115,36534233,36534235,36534244,36534264,36534410,36534445,36534486,36534506,36534513,36534531,36534545,36534571,36534583,36534587,36534603,36534684,36534761,36534806,36534828,36534834,36534856,36534868,36534895,36534920,36534962,36534965,36534981,36535017,36535027,36535029,36535046,36535054,36535059,36535094,36535103,36535130,36535134,36535156,36535190,36535193,36535206,36535218,36535299,36535361,36535374,36535383,36535409,36535424,36535443,36535451,36535474,36535496,36535505,36535516,36535542,36535581,36535598,36535690,36535700,36535708,36535730,36535759,36535782,36535794,36535807,36535808,36535906,36535921,36535927,36535932,36535940,36535965,36535971,36535982,36535985,36535992,36535999,36536080,36536128,36536149,36536159,36536167,36536186,36536194,36536244,36536255,36536267,36536285,36536292,36536344,36536385,36536470,36536494,36536517,36536526,36536547,36536592,36536638,36536671,36536684,36536694,36536705,36536706,36536760,36536776,36536818,36536846,36536849,36536909,36536983,36536990,36537003,36537010,36537037,36537049,36537091,36537096,36537114,36537122,36537126,36537140,36537160,36537164,36537168,36537175,36537193,36537222,36537231,36537251,36537278,36537286,36537319,36537339,36537341,36537343,36537349,36537360,36537416,36537417,36537443,36537468,36537492,36537505,36537516,36537541,36537597,36537598,36537599,36537611,36537617,36537664,36537674,36537732,36537743,36537755,36537759,36537765,36537787,36537801,36537843,36537852,36537870,36537879,36537950,36537977,36537984,36537996,36538027,36538040,36538049,36538055,36538063,36538065,36538086,36538094,36538123,36538124,36538137,36538204,36538211,36538278,36538298,36538307,36538371,36538410,36538439,36538446,36538467,36538477,36538490,36538515,36538543,36538556,36538589,36538613,36538676,36538693,36538711,36538726,36538730,36538745,36538750,36538767,36538786,36538826,36538840,36538903,36538922,36538983,36538995,36539019,36539022,36539025,36539047,36539069,36539078,36539095,36539130,36539151,36539197,36539227,36539233,36539288,36539317,36539331,36539348,36539379,36539401,36539410,36539421,36539434,36539436,36539465,36539468,36539473,36539561,36539581,36539610,36539621,36539631,36539670,36539706,36539711,36539752,36539824,36539835,36539868,36539899,36539925,36539939,36539946,36539957,36540002,36540006,36540010,36540018,36540032,36540068,36540078,36540140,36540144,36540176,36540184,36540187,36540233,36540252,36540297,36540320,36540335,36540374,36540424,36540458,36540467,36540473,36540492,36540495,36540499,36540507,36540540,36540543,36540729,36540739,36540743,36540807,36540971,36541022,36541046,36541079,36541118,36541132,36541134,36541201,36541215,36541236,36541284,36541317,36541320,36541366,36541368,36541370,36541391,36541424,36541456,36541490,36541552,36541564,36541568,36541585,36541625,36541628)
neuropathy <- c(neuropathy, 36541637,36541639,36541657,36541741,36541769,36541795,36541800,36541813,36541836,36541856,36541907,36541913,36541915,36541920,36541963,36541972,36541982,36541993,36542017,36542037,36542046,36542050,36542071,36542084,36542094,36542101,36542109,36542110,36542133,36542134,36542141,36542143,36542177,36542179,36542185,36542187,36542270,36542275,36542297,36542318,36542320,36542326,36542366,36542377,36542381,36542382,36542387,36542406,36542428,36542437,36542451,36542463,36542545,36542575,36542577,36542613,36542637,36542662,36542691,36542718,36542806,36542907,36542909,36542951,36542967,36542984,36543027,36543036,36543071,36543097,36543101,36543113,36543127,36543147,36543174,36543186,36543203,36543244,36543250,36543258,36543283,36543292,36543329,36543339,36543341,36543353,36543359,36543402,36543445,36543470,36543501,36543512,36543534,36543540,36543545,36543591,36543598,36543661,36543777,36543809,36543831,36543846,36543847,36543856,36543881,36543892,36543900,36543924,36543995,36544057,36544058,36544128,36544132,36544174,36544189,36544238,36544305,36544327,36544333,36544334,36544402,36544440,36544496,36544513,36544528,36544557,36544575,36544582,36544600,36544605,36544629,36544721,36544731,36544741,36544742,36544745,36544788,36544839,36544862,36544872,36544873,36544887,36544930,36544932,36544943,36545004,36545041,36545076,36545175,36545185,36545215,36545220,36545223,36545237,36545250,36545306,36545313,36545322,36545331,36545352,36545368,36545392,36545413,36545421,36545432,36545450,36545451,36545452,36545527,36545541,36545602,36545639,36545656,36545659,36545671,36545681,36545696,36545709,36545714,36545744,36545752,36545778,36545787,36545848,36545907,36545979,36546025,36546032,36546038,36546046,36546079,36546099,36546121,36546137,36546200,36546239,36546251,36546340,36546363,36546394,36546417,36546418,36546453,36546459,36546475,36546479,36546497,36546507,36546515,36546526,36546528,36546536,36546596,36546602,36546603,36546606,36546632,36546676,36546715,36546716,36546718,36546778,36546784,36546804,36546805,36546826,36546876,36546921,36546926,36546927,36546928,36546960,36546964,36547012,36547051,36547130,36547132,36547137,36547160,36547164,36547177,36547179,36547234,36547278,36547308,36547314,36547345,36547367,36547406,36547435,36547450,36547473,36547489,36547535,36547559,36547620,36547631,36547633,36547659,36547665,36547669,36547719,36547732,36547747,36547809,36547822,36547833,36547949,36547957,36547963,36547988,36548007,36548011,36548068,36548092,36548143,36548152,36548188,36548189,36548210,36548257,36548265,36548275,36548276,36548297,36548301,36548344,36548363,36548395,36548399,36548415,36548424,36548455,36548479,36548488,36548497,36548512,36548519,36548531,36548546,36548598,36548599,36548607,36548629,36548649,36548666,36548753,36548761,36548774,36548786,36548792,36548819,36548827,36548833,36548847,36548858,36548907,36548915,36548916,36548964,36548990,36549006,36549034,36549047,36549049,36549064,36549066,36549094,36549129,36549130,36549135,36549136,36549195,36549226,36549261,36549329,36549354,36549387,36549391,36549394,36549462,36549474,36549517,36549534,36549547,36549577,36549579,36549615,36549620,36549636)
neuropathy <- c(neuropathy, 36549676,36549687,36549697,36549711,36549714,36549783,36549793,36549803,36549805,36549820,36549836,36549860,36549862,36549910,36549935,36549942,36549963,36549965,36549985,36549988,36549990,36550030,36550055,36550075,36550094,36550167,36550217,36550238,36550243,36550246,36550248,36550260,36550291,36550317,36550348,36550361,36550363,36550372,36550393,36550433,36550476,36550490,36550499,36550508,36550509,36550564,36550568,36550594,36550606,36550675,36550676,36550703,36550705,36550720,36550727,36550741,36550750,36550803,36550831,36550962,36550979,36550983,36550991,36550992,36551005,36551006,36551024,36551050,36551090,36551213,36551232,36551259,36551296,36551300,36551306,36551318,36551324,36551446,36551473,36551488,36551525,36551531,36551535,36551536,36551561,36551564,36551565,36551579,36551626,36551636,36551652,36551657,36551658,36551701,36551711,36551731,36551774,36551807,36551812,36551815,36551863,36551968,36551969,36551989,36552004,36552021,36552030,36552040,36552054,36552067,36552073,36552113,36552180,36552195,36552197,36552202,36552207,36552233,36552250,36552253,36552257,36552273,36552287,36552290,36552293,36552318,36552321,36552350,36552369,36552379,36552401,36552404,36552493,36552529,36552558,36552572,36552648,36552658,36552705,36552725,36552750,36552785,36552809,36552825,36552841,36552846,36552863,36552968,36552990,36553036,36553050,36553099,36553109,36553119,36553122,36553167,36553174,36553192,36553206,36553233,36553257,36553266,36553329,36553337,36553408,36553411,36553433,36553440,36553491,36553494,36553515,36553544,36553608,36553610,36553702,36553710,36553728,36553752,36553765)
neuropathy <- c(neuropathy, 36553774,36553829,36553861,36553864,36553866,36553886,36553901,36553904,36553952,36553978,36554014,36554020,36554173,36554182,36554188,36554199,36554206,36554285,36554288,36554289,36554305,36554356,36554361,36554382,36554412,36554413,36554419,36554444,36554476,36554495,36554499,36554529,36554541,36554674,36554735,36554779,36554796,36554818,36554820,36554833,36554865,36554881,36554891,36554899,36554932,36554960,36555033,36555072,36555078,36555084,36555121,36555150,36555219,36555221,36555227,36555232,36555259,36555280,36555281,36555307,36555361,36555392,36555399,36555422,36555425,36555466,36555589,36555604,36555632,36555640,36555642,36555643,36555647,36555670,36555719,36555721,36555734,36555740,36555758,36555808,36555842,36555849,36555852,36555872,36555874,36555878,36555942,36555959,36556064,36556153,36556165,36556166,36556170,36556179,36556217,36556247,36556367,36556438,36556459,36556462,36556499,36556568,36556580,36556584,36556592,36556625,36556654,36556667,36556679,36556681,36556751,36556802,36556808,36556889,36556938,36556952,36556964,36557055,36557118,36557122,36557151,36557159,36557177,36557201,36557211,36557258,36557263,36557285,36557322,36557346,36557385,36557462,36557505,36557540,36557596,36557650,36557665,36557748,36557760,36557770,36557773,36557795,36557843,36557847,36557860,36557875,36557884,36557898,36557931,36557939,36557962,36557964,36557969,36557974,36557992,36558036,36558040,36558041,36558106,36558109,36558126,36558129,36558144,36558159,36558167,36558171,36558177,36558180,36558215,36558217,36558223,36558232,36558249,36558252,36558290,36558318,36558384,36558449,36558465,36558513,36558516,36558518,36558541,36558548,36558586,36558593,36558623,36558677,36558741,36558749,36558777,36558845,36558860,36558871,36558874,36558892,36558913,36558914,36558959,36558982,36558992,36559000,36559014,36559019,36559024,36559047,36559069,36559073,36559109,36559132,36559179,36559190,36559217,36559242,36559284,36559301,36559390,36559391,36559402,36559409,36559412,36559444,36559445,36559491,36559493,36559514,36559517,36559553,36559558,36559564,36559577,36559585,36559589,36559653,36559657,36559709,36559716,36559777,36559788,36559835,36559845,36559884,36559904,36559911,36559918,36559960,36559980,36559995,36560024,36560026,36560030,36560074,36560151,36560174,36560187,36560253,36560259,36560287,36560289,36560300,36560313,36560333,36560339,36560360,36560364,36560393,36560404,36560425,36560426,36560433,36560481,36560491,36560494,36560502,36560523,36560533,36560534,36560598,36560609,36560699,36560701,36560712,36560738,36560778,36560805,36560878,36560895,36560956,36560998,36561014,36561015,36561025,36561057,36561062,36561109,36561115,36561123,36561134,36561135,36561166)
neuropathy <- c(neuropathy, 36561170,36561173,36561232,36561311,36561314,36561335,36561351,36561370,36561374,36561379,36561389,36561421,36561428,36561446,36561459,36561468,36561470,36561494,36561510,36561523,36561564,36561590,36561607,36561642,36561677,36561684,36561725,36561731,36561732,36561742,36561780,36561781,36561820,36561878,36561892,36561895,36561908,36561949,36561950,36561953,36562025,36562045,36562110,36562117,36562127,36562128,36562175,36562181,36562194,36562197,36562204,36562218,36562227,36562228,36562237,36562239,36562252,36562309,36562317,36562357,36562389,36562402,36562413,36562451,36562457,36562467,36562502,36562511,36562517,36562527,36562572,36562607,36562651,36562735,36562743,36562792,36562797,36562874,36562879,36562890,36562895,36562899,36562948,36562972,36562984,36562987,36563034,36563057,36563064,36563087,36563088,36563118,36563121,36563135,36563143,36563215,36563223,36563235,36563241,36563246,36563248,36563254,36563258,36563290,36563364,36563399,36563407,36563432,36563441,36563445,36563459,36563466,36563504,36563515,36563578,36563590,36563625,36563628,36563637,36563674,36563731,36563734,36563739,36563811,36563820,36563892,36563896,36563910,36563926,36563934,36563961,36563968,36563976,36564006,36564037,36564048,36564087,36564221,36564239,36564275,36564351,36564368,36564405,36564419,36564431,36564476,36564493,36564575,36564602,36564615,36564641,36564651,36564742,36564749,36564765,36564767,36564898,36564920,36565016,36565030,36565031,36565035,36565045,36565056,36565107,36565161,36565197,36565207,36565219,36565226,36565230,36565242,36565257,36565299,36565309,36565319,36565426,36565431,36565434,36565467,36565494,36565498,36565508,36565529,36565541,36565563,36565610,36565616,36565630,36565663,36565668,36565725,36565729,36565733,36565735,36565743,36565809,36565814,36565836,36565841,36565881,36565890,36565962,36565993,36565997,36566022,36566026,36566051,36566057,36566062,36566076,36566086,36566096,36566111,36566122,36566182,36566203,36566207,36566210,36566252,36566295,36566325,36566344,36566403,36566417,36566437,36566439,36566458,36566491,36566505,36566507,36566522,36566536,36566537,36566538,36566539,36566547,36566587,36566603,36566608,36566611,36566662,36566679,36566693,36566702,36566726,36566733,36566835,36566855,36566883,36566895,36566914,36566936,36566958,36566965,36567011,36567013,36567015,36567078,36567109,36567115,36567120,36567147,36567175,36567228,36567235,36567263,36567285,36567286,36567312,36567322,36567347,36567351,36567364,36567365,36567376,36567413,36567504,36567510,36567561,36567673,36567733,36567743,36567745,36567771,36567780,36567788)
neuropathy <- c(neuropathy, 36567812,36567827,36567831,36567833,36567850,36567855,36567889,36567893,36567916,36567933,36567942,36567975,36567976,36568084,36568110,36568219,36568256,36568318,36568325,36674513,36674519,36674764,36674787,36674788,36674826,36674867,36674914,36675024,36675026,36675041,36675043,36675060,36675143,36675179,36676493,36676852,36680577,36684203,36684263,36684265,36684423,36684609,36684610,36684651,36684658,36684716,36684724,36684778,36685064,36685117,36685190,36685191,36685261,36685262,36686116,36686117,36686130,36686162,36686268,36686269,36686270,36686271,36686332,36686333,36686936,36686937,36686938,36687008,36687089,36687177,36687189,36687226,36687227,36712849,36712930,36713167,36713483,36713484,36713563,36713608,36714330,36714331,36714332,36714333,36714335,36714547,36714552,36714655,36714663,36714971,36715138,36715333,36715501,36715503,36715518,36715519,36715546,36715671,36715672,36715673,36715674,36715773,36715774,36715775,36715776,36715779,36715838,36716032,36716159,36716264,36716396,36716429,36716493,36716560,36716561,36716599,36716698,36716699,36716804,36716805,36716806,36716901,36716912,36716942,36717015,36717041,36717042,36717085,36717089,36717132,36717151,36717190,36717250,36717345,36717457,36717481,36717573,36717726,37016354,37016648,37016748,37016767,37016768,37017214,37017262,37017429,37017430,37017431,37017432,37017462,37017469,37017537,37017539,37017543,37017545,37017552,37017593,37017608,37017703,37018566,37018714,37018721,37018728,37018918,37018987,37019034,37108904,37108905,37108906,37108959,37108965,37108966,37108968,37108969,37109017,37109018,37109547,37109548,37109673,37109694,37109776,37109793,37109811,37109886,37109887,37110099,37110170,37110337,37110342,37110346,37110506,37110529,37110530,37110531,37110532,37110533,37110534,37110535,37110536,37110537,37110543,37110680,37110681,37110682,37110683,37110720,37110771,37111328,37116362,37116378,37116393,37116696,37116960,37117079,37117236,37117750,37119156,37119157,37203915,37203958,37203960,37204178,37204221,37204229,37204233,37204274,37204276,37204278,37204281,37204369,37204410,37204431,37204432,37204510,37204522,37204541,37204553,37204686,37204831,37205047,37205069,37206118,37207657,37207850,37207860,37207910,37207920,37207971,37207978,37208011,37208012,37208016,37208017,37208021,37208253,37209318,37209319,37209361,37209362,37209437,37209438,37209439,37209443,37209444,37209445,37209555,37209556,37209559,37309618,37309622,37309624,37309668,37310094,37310180,37310181,37310182,37310183,37310184,37310185,37310186,37310187,37310201,37310202,37310203,37310208,37310209,37310572,37310573,37311162,37311163,37311164,37311165,37311495,37311496,37311885,37311886,37311887,37311989)
neuropathy <- c(neuropathy, 37312091,37312156,37312197,37312198,37312218,37312612,37312613,37312614,37312615,37312616,37312738,37395587,37396086,37396221,37396434,37396785,37396786,37397000,37397001,37397002,37397003,37397004,37397005,37397007,37397028,37397207,37397260,37397359,37397457,37397549,37399444,37399460,37399469,37399736,40479564,40481053,40481904,40482511,40483299,40483619,40483696,40483791,40483815,40485984,40486652,40487958,40490353,40492797,40493211,42511642,42511650,42511658,42511663,42511678,42511711,42511715,42511718,42511739,42511774,42511784,42511786,42511814,42511860,42511893,42511908,42511923,42511955,42511973,42512018,42512032,42512036,42512041,42512065,42512090,42512105,42512135,42512160,42512166,42512178,42512217,42512234,42512248,42512253,42512263,42512316,42512322,42512331,42512337,42512358,42512360,42512361,42512368,42512395,42512410,42512412,42512442,42512457,42512466,42512551,42512562,42512582,42512591,42512635,42512636,42512637,42512638,42512651,42512662,42512667,42512686,42512730,42512736,42512737,42512753,42512760,42512763,42512778,42512789,42512792,42512798,42512814,42512818,42512850,42512865,42512907,42512940,42512985,42514460,42514461,42514462,42514463,42514464,42534978,42535095,42535099,42535101,42535102,42535116,42535117,42535118,42535151,42535152,42535153,42535154,42535155,42535156,42535188,42535189,42535190,42535194,42535195,42535196,42535197,42535198,42535199,42535217,42535218,42535219,42535220,42535221,42535222,42535223,42535225,42535408,42535409,42535430,42535431,42535432,42535433,42535434,42535435,42535436,42535437,42535438,42535439,42535440,42535441,42535442,42535443,42535446,42535447,42535448,42535449,42535451,42535452,42535455,42535462,42535463,42535464,42535469,42535470,42535471,42535472,42535513,42535514,42535515,42535519,42535520,42535522,42535526,42535527,42535539,42536258,42536259,42536260,42536697,42536756,42536757,42536758,42536759,42536760,42536761,42536881,42537442,42537550,42537669,42537705,42537706,42538614,42538615,42538616,42538791,42538839,42538840,42539164,42539169,42539187,42539188,42539198,42539208,42539216,42539252,42539253,42539258,42539264,42539273,42539275,42539277,42539280,42539285,42539474,42572862,42596478,42596648,42596652,42596653,42597080,42597201,42598759,42599606,42600400,42710044,43020789,43020790,43530607,43530618,43530689,43530705,43530707,43530713,43530726,43530756,43530862,43530983,43530984,43531026,43531027,43531028,43531029,43531030,43531033,43531034,43531035,43531039,43531047,43531048,43531074,43531075,43531077,43531078,43531175,43531560,43531561,43531563,43531649,43531652,43531654,43531692,44499406,44499600,44499602,44499656,44499663,44499822,44499851,44499914,44500169,44500172,44500222,44500319,44500621,44500670,44500908,44500957,44501050,44501300,44501375,44501688,44501755,44501986,44501991,44502070,44502197,44502257,44502413,44502672,44503184,44503351,44503352,44782526,44782794,44782795,44782796,44783024,44783025,44783026,44783143,44783201,44783202,44783873,44783874,44784628,44805212,44809714,45757202,45757236,45757257,45757271,45757278,45765490,45765491,45766388,45768456,45769830,45769894,45770924,45773567,46269858,46270109,46270482,46271082,46271103,46271104,46271105,46271149,46271211,46271378,46271935,46272050,46272057,46272058,46272059,46272949,46273207,46273291,46273297,46273298,46274079)

resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% neuropathy) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: Neuropathy"

# Medical history: Nephropathy
nephropathy <- c(196455,196464,197035,197253,197320,197329,259070,432961,435003,435308,435320,444044,761083,762464,3180351,3180540,3189598,3654660,3661748,4027117,4030519,4030671,4031999,4032295,4032296,4032298,4042397,4054915,4054992,4056023,4056472,4056473,4056474,4056475,4058837,4058985,4058986,4058988,4058989,4058990,4058991,4059454,4059455,4059456,4059457,4059458,4066005,4066405,4070939,4100954,4102631,4111399,4119093,4125953,4125957,4125968,4125969,4125971,4126112,4126131,4126300,4126301,4126305,4126424,4126426,4126427,4126439,4127550,4127551,4128029,4128067,4128371,4137752,4139414,4139915,4143190,4149888,4151112,4152839,4159967,4160274,4173196,4180453,4181114,4188623,4189531,4190190,4195297,4200639,4210158,4215648,4219863,4220051,4228827,4232873,4234761,4239213,4242411,4251796,4264681,4265212,4267646,4272470,4272486,4280571,4284491,4284564,4286024,4302298,4303512,4306513,4308408,4310661,4311129,4329572,4343933,36716182,36716183,36716312,36716946,36717581,37016360,37016366,37018343,37018344,37018345,37019162,37111531,37116430,37116431,37116432,37116834,37208344,37312165,37395514,37395516,37395517,37395518,37395519,37395520,37395521,37399017,40481064,40481595,40482881,43530914,43530928,43530935,44808128,44808338,44808340,44808744,44808821,44808822,44808823,44809061,44809062,44809063,44809170,44809173,44809286,44813789,44813790,45757398,45757442,45757466,45757746,45765710,45772126)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% nephropathy) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical histroy: Nephropathy"

# Medical history: ACS + angina
acsangina <- c(312327,315296,315830,315832,319039,321318,434376,436706,438170,438438,438447,441579,444406,761735,761736,761737,3654465,3654466,3654467,3655133,3661502,3661503,3661504,3661520,3661524,3661547,3661641,3661642,3661643,3661644,3661645,3661646,4051874,4068938,4078531,4108669,4108670,4116486,4119455,4119456,4119457,4119942,4119943,4119944,4119945,4119946,4119947,4119948,4121464,4121465,4121466,4124684,4124685,4126801,4145721,4151046,4155008,4155009,4155963,4161456,4161457,4161973,4161974,4178129,4184827,4198141,4201629,4231426,4243372,4262446,4264145,4267568,4270024,4275436,4296653,4303359,4310270,4324413,4324893,35610091,35610093,35611570,35611571,35615052,35615053,36712982,36712983,36712984,37209632,37309713,43020460,43531588,44782712,44782769,45766075,45766076,45766115,45766116,45766150,45766151,45771322,46270158,46270159,46270160,46270161,46270162,46270163,46270164,46273495,46274044)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% acsangina) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "History of atherosclerotic vascular disease: coronary "

# Medical history: Nonhemorrhagic stroke 
ich <- c(372435,377254,379778,443454,443790,443864,444091,761110,762933,762934,762935,762937,762951,763015,765515,3179950,3184775,3185378,3188164,4031045,4043731,4043732,4045735,4045737,4045738,4045740,4045741,4046089,4046090,4046237,4046358,4046359,4046360,4046361,4046362,4048784,4077086,4108356,4110189,4110190,4110192,4111714,4119140,4129534,4131383,4138327,4141405,4142739,4145897,4146185,4298750,4319146,35610084,35610085,36717605,37110678,37110679,37116473,37395562,40479572,42535465,42535466,42535523,42535524,43530683,43531607,44782773,45767658,45772786,46270031,46270380,46270381,46273649)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% ich) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "History of atherosclerotic vascular disease: cerebrovascular"

# Medical history: peripheral arterial disease
pvd <- c(134380,192657,195834,200132,314965,315558,317309,318712,321052,321822,434961,439836,441044,443407,443408,443729,444264,760869,760870,760871,761206,761428,761429,761430,761431,761432,761433,761434,761463,761464,761465,761466,761467,761740,761741,761742,761743,761744,761748,761749,761804,761805,761812,761813,761814,761815,761816,761822,761823,761824,761825,761826,761827,761828,761829,761853,761854,761858,762053,764026,765079,765080,765226,765284,765300,765301,3171253,3173537,3173780,3176677,3176693,3181089,3184873,3192767,3198350,3654996,4025854,4030663,4033350,4055025,4055720,4108375,4108376,4108377,4108380,4108381,4110331,4110333,4111848,4111850,4112161,4112162,4114011,4115229,4116977,4117679,4117933,4118795,4119141,4119612,4119614,4120098,4121625,4121626,4121627,4124836,4124837,4124838,4124839,4127997,4131908,4136335,4137550,4137551,4139534,4139577,4139578,4139579,4140616,4141106,4141975,4143588,4146012,4151848,4153293,4168060,4173167,4174012,4174013,4174014,4174015,4175569,4175570,4178399,4178400,4178609,4179907,4179908,4179909,4179910,4182191,4193056,4193057,4193302,4194886,4195971,4195972,4195973,4199183,4199887,4200875,4202511,4208071,4208072,4208809,4208944,4226026,4231816,4231826,4235591,4236905,4246643,4253510,4263089,4263648,4264734,4289307,4291464,4294425,4299117,4299127,4301022,4301023,4301024,4316367,4318843,4329498,4337367,4341646,4348039,4348319,35611566,35615018,35615019,35615020,35615021,35615028,35615036,35615054,35615061,35615062,35615063,35615071,35615073,35615075,35615076,35615080,35615081,35615082,35615083,35615086,35615087,35615088,35615089,35615090,35615091,35615092,35615093,35615094,35615095,35615096,35615097,35615098,35615099,35615100,35615106,35615107,35615116,36712805,36712807,36712955,36712987,36713012,36713013,36713014,36713015,36713094,36717256,37016147,37017533,37109921,37109923,37110250,37110251,37116421,37116422,37209668,37312530,40483538,40484541,40484551,40484912,42535143,42535335,42535829,42536634,42536636,42539410,42572961,42597028,42597030,42599607,42599802,42599894,43020443,43021846,43022064,44782775,44782819,44808745,44808746,44808747,44808832,44808833,44813802,44813823,46271459,46271460,46271462)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% pvd) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "History of atherosclerotic vascular disease: peripheral"

# Medical history: History of atherosclerotic vascular disease: any
anyathero <- c(acsangina, ich, pvd)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% anyathero) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "History of atherosclerotic vascular disease: any"

# Medical history: History of CVD
cvd <- c(313217, 381591, 317576, 321588, 316139, 4185932, 321052, 440417, 444247)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% cvd) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical history: History of CVD"

# Medical history: History of amputation
amputation <- c(75112,79957,198287,198594,198900,200877,432762,438598,443917,443982,444073,760806,765371,4050383,4050385,4050387,4050389,4051294,4051298,4051439,4051440,4053123,4053124,4053125,4053126,4053127,4053128,4053149,4054066,4056290,4056291,4056293,4056294,4056297,4056298,4056434,4056435,4096480,4148693,4195268,4198759,4231695,4308552,4309488,4318111,4319151,4319152,4320023,4320024,4320025,37110644,37116498,37116542,37116543,37119238,37119300,40483816,42536713,42536714,42536847,42538749,44806489,44807046, 764236,764237,764238,765624,2006242,2006243,2104950,2105209,2105210,2105211,2105222,2105223,2105446,2105447,2105448,2105449,2105450,2105451,2105804,2105805,2105806,2105807,2105808,2719984,2719985,2719994,3168091,3173821,3174572,3181155,3182628,3187877,4002166,4008397,4018719,4020884,4034325,4034326,4034551,4035764,4053140,4054498,4054983,4062385,4067621,4078563,4080100,4083397,4083398,4108565,4108567,4119910,4143795,4143796,4143797,4146410,4159766,4169822,4177620,4183102,4195136,4217266,4218050,4219032,4226945,4227157,4234959,4242396,4246689,4246691,4264278,4264289,4264290,4264716,4272232,4287928,4302020,4338257,35622529,36674416,36674417,36715395,36715396,36715397,36717437,37109581,37109582,37109822,37109845,37109850,37109895,37115742,37115743,37116276,37118034,37118455,37204044,37206818,37206819,37206860,40479688,44515920,44515922,44515928,44515930,44515932)
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %in% amputation) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Medical history: History of CVD"

# BMI 
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 40762636)))

# Systolic blood pressure  mm Hg
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3004249)))

# Diastolic blood pressure  mm Hg
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3012888)))

# glycated hemoglobin
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3004410)))

# 	Cholesterol [Mass/volume] in Serum or Plasma	
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3027114)))

# 	Cholesterol in HDL [Mass/volume] in Serum or Plasma	
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3007070)))

# 	Cholesterol in LDL [Mass/volume] in Serum or Plasma	
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3028437)))

#	Triglyceride [Mass/volume] in Serum or Plasma
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3022192)))
                           
#EGFR
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3029859))[1,])

#Median albumin-to-creatinine ratio
resultTablePooled <- rbind(resultTablePooled, data.frame(statisticsPooled %>% filter(conceptId %like% 3020682))[1,])

# Normoalbuminuria
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %like% 3020682, covariateValue < 30) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Normoalbuminuria"

# Microalbuminuria
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %like% 3027108, covariateValue >= 30, covariateValue <300) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Microalbuminuria"

# Renal function, creatinine clearance
resultTablePooled[nrow(resultTablePooled)+1, c("n")] <- data.frame(covariates$covariates %>% filter(conceptId %like% 3027108, covariateValue >= 300) %>% summarise(n = n_distinct(.data$rowId)))
resultTablePooled[nrow(resultTablePooled), c("covariateName")] <- "Macroalbuminuria"

## final table
resultTablePooledOI <- resultTablePooled

############## compute value
RCTbaseline$OEvalue_RCT <- 0
RCTbaseline$OIvalue_RCT <- 0

#mean
idx <- which(RCTbaseline$typeofstatistics=="mean")
RCTbaseline$OEvalue_RCT[idx] <- (resultTablePooledOE[idx,]$mean - (RCTbaseline[idx,]$target * (RCTbaseline$targetsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])) + RCTbaseline[idx,]$comparator * (RCTbaseline$comparatorsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])))) / ((RCTbaseline[idx,]$targetsd * (RCTbaseline$targetsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])) + RCTbaseline[idx,]$comparatorsd * (RCTbaseline$comparatorsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1]))) + resultTablePooledOE[idx,]$sd)/2
RCTbaseline$OIvalue_RCT[idx] <- (resultTablePooledOI[idx,]$mean - (RCTbaseline[idx,]$target * (RCTbaseline$targetsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])) + RCTbaseline[idx,]$comparator * (RCTbaseline$comparatorsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])))) / ((RCTbaseline[idx,]$targetsd * (RCTbaseline$targetsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])) + RCTbaseline[idx,]$comparatorsd * (RCTbaseline$comparatorsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1]))) + resultTablePooledOI[idx,]$sd)/2

#median

#category 
idx <- which(RCTbaseline$typeofstatistics=="category")
RCTbaseline$OEvalue_RCT[idx] <- (resultTablePooledOE$n[idx] / sizeOE[1,2]) - (RCTbaseline[idx,]$target + RCTbaseline[idx,]$comparator) / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])
RCTbaseline$OIvalue_RCT[idx] <- (resultTablePooledOI$n[idx] / sizeOI[1,2]) - (RCTbaseline[idx,]$target + RCTbaseline[idx,]$comparator) / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])

RCTbaseline$OEvalue <- NA
RCTbaseline$OIvalue <- NA
RCTbaseline$OEvalue[idx] <- resultTablePooledOE$n[idx] / sizeOE[1,2]
RCTbaseline$OIvalue[idx] <- resultTablePooledOI$n[idx] / sizeOI[1,2]

#percent
idx <- which(RCTbaseline$typeofstatistics=="percent")
RCTbaseline$OEvalue_RCT[idx] <- (resultTablePooledOE$n[idx] / sizeOE[1,2]) - (((RCTbaseline[idx,]$target * RCTbaseline$targetsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])) + ((RCTbaseline[idx,]$comparator * RCTbaseline$comparatorsize[1]) / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1]))) / 100)
RCTbaseline$OIvalue_RCT[idx] <- (resultTablePooledOI$n[idx] / sizeOI[1,2]) - (((RCTbaseline[idx,]$target * RCTbaseline$targetsize[1] / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1])) + ((RCTbaseline[idx,]$comparator * RCTbaseline$comparatorsize[1]) / (RCTbaseline$targetsize[1] + RCTbaseline$comparatorsize[1]))) / 100)

filename <- paste0(trials, '.csv')
filename <- file.path("C:/output/TroyOhdsi", filename)
write.csv(RCTbaseline, filename)
